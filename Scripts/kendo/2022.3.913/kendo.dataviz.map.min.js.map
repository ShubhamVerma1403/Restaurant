{"version":3,"file":"kendo.dataviz.map.min.js","sources":["kendo.dataviz.map.js"],"sourcesContent":["(function(f, define) {\r\n    define('util/main',[\r\n        \"kendo.core\"\r\n    ], f);\r\n})(function() {\r\n\r\n(function () {\r\n    // Imports ================================================================\r\n    var kendo = window.kendo,\r\n        deepExtend = kendo.deepExtend;\r\n\r\n    function sqr(value) {\r\n        return value * value;\r\n    }\r\n\r\n    var now = Date.now;\r\n    if (!now) {\r\n        now = function() {\r\n            return new Date().getTime();\r\n        };\r\n    }\r\n\r\n    // Template helpers =======================================================\r\n\r\n    function renderSize(size) {\r\n        if (typeof size !== \"string\") {\r\n            size += \"px\";\r\n        }\r\n\r\n        return size;\r\n    }\r\n\r\n    function renderPos(pos) {\r\n        var result = [];\r\n\r\n        if (pos) {\r\n            var parts = kendo.toHyphens(pos).split(\"-\");\r\n\r\n            for (var i = 0; i < parts.length; i++) {\r\n                result.push(\"k-pos-\" + parts[i]);\r\n            }\r\n        }\r\n\r\n        return result.join(\" \");\r\n    }\r\n\r\n    function arabicToRoman(n) {\r\n        var literals = {\r\n            1    : \"i\",       10   : \"x\",       100  : \"c\",\r\n            2    : \"ii\",      20   : \"xx\",      200  : \"cc\",\r\n            3    : \"iii\",     30   : \"xxx\",     300  : \"ccc\",\r\n            4    : \"iv\",      40   : \"xl\",      400  : \"cd\",\r\n            5    : \"v\",       50   : \"l\",       500  : \"d\",\r\n            6    : \"vi\",      60   : \"lx\",      600  : \"dc\",\r\n            7    : \"vii\",     70   : \"lxx\",     700  : \"dcc\",\r\n            8    : \"viii\",    80   : \"lxxx\",    800  : \"dccc\",\r\n            9    : \"ix\",      90   : \"xc\",      900  : \"cm\",\r\n            1000 : \"m\"\r\n        };\r\n        var values = [ 1000,\r\n                       900 , 800, 700, 600, 500, 400, 300, 200, 100,\r\n                       90  , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\r\n                       9   , 8  , 7  , 6  , 5  , 4  , 3  , 2  , 1 ];\r\n        var roman = \"\";\r\n        while (n > 0) {\r\n            if (n < values[0]) {\r\n                values.shift();\r\n            } else {\r\n                roman += literals[values[0]];\r\n                n -= values[0];\r\n            }\r\n        }\r\n        return roman;\r\n    }\r\n\r\n    function romanToArabic(r) {\r\n        r = r.toLowerCase();\r\n        var digits = {\r\n            i: 1,\r\n            v: 5,\r\n            x: 10,\r\n            l: 50,\r\n            c: 100,\r\n            d: 500,\r\n            m: 1000\r\n        };\r\n        var value = 0, prev = 0;\r\n        for (var i = 0; i < r.length; ++i) {\r\n            var v = digits[r.charAt(i)];\r\n            if (!v) {\r\n                return null;\r\n            }\r\n            value += v;\r\n            if (v > prev) {\r\n                value -= 2 * prev;\r\n            }\r\n            prev = v;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    function memoize(f) {\r\n        var cache = Object.create(null);\r\n        return function() {\r\n            var id = \"\";\r\n            for (var i = arguments.length; --i >= 0;) {\r\n                id += \":\" + arguments[i];\r\n            }\r\n            return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\r\n        };\r\n    }\r\n\r\n    function isUnicodeLetter(ch) {\r\n        return RX_UNICODE_LETTER.test(ch);\r\n    }\r\n\r\n    function withExit(f, obj) {\r\n        try {\r\n            return f.call(obj, function(value){\r\n                throw new Return(value);\r\n            });\r\n        } catch(ex) {\r\n            if (ex instanceof Return) {\r\n                return ex.value;\r\n            }\r\n            throw ex;\r\n        }\r\n        function Return(value) {\r\n            this.value = value;\r\n        }\r\n    }\r\n\r\n    // Exports ================================================================\r\n    deepExtend(kendo, {\r\n        util: {\r\n            now: now,\r\n            renderPos: renderPos,\r\n            renderSize: renderSize,\r\n            sqr: sqr,\r\n            romanToArabic: romanToArabic,\r\n            arabicToRoman: arabicToRoman,\r\n            memoize: memoize,\r\n            isUnicodeLetter: isUnicodeLetter,\r\n            withExit: withExit\r\n        }\r\n    });\r\n\r\n    var RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\r\n\r\n})();\r\n\r\nreturn window.kendo;\r\n\r\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\r\n\n(function(f, define) {\n    define('dataviz/map/location',[ \"kendo.drawing\", \"../../util/main\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var math = Math,\n        abs = math.abs,\n        atan = math.atan,\n        atan2 = math.atan2,\n        cos = math.cos,\n        max = math.max,\n        min = math.min,\n        sin = math.sin,\n        tan = math.tan,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        util = kendo.drawing.util,\n        defined = util.defined,\n        deg = util.deg,\n        rad = util.rad,\n        round = util.round,\n        valueOrDefault = util.valueOrDefault,\n\n        sqr = kendo.util.sqr;\n\n    // Implementation =========================================================\n    var Location = Class.extend({\n        init: function(lat, lng) {\n            if (arguments.length === 1) {\n                this.lat = lat[0];\n                this.lng = lat[1];\n            } else {\n                this.lat = lat;\n                this.lng = lng;\n            }\n        },\n\n        DISTANCE_ITERATIONS: 100,\n        DISTANCE_CONVERGENCE: 1e-12,\n        DISTANCE_PRECISION: 2,\n        FORMAT: \"{0:N6},{1:N6}\",\n\n        toArray: function() {\n            return [this.lat, this.lng];\n        },\n\n        equals: function(loc) {\n            return loc && loc.lat === this.lat && loc.lng === this.lng;\n        },\n\n        clone: function() {\n            return new Location(this.lat, this.lng);\n        },\n\n        round: function(precision) {\n            this.lng = round(this.lng, precision);\n            this.lat = round(this.lat, precision);\n            return this;\n        },\n\n        wrap: function() {\n            this.lng = this.lng % 180;\n            this.lat = this.lat % 90;\n            return this;\n        },\n\n        distanceTo: function(dest, datum) {\n            return this.greatCircleTo(dest, datum).distance;\n        },\n\n        destination: function(distance, bearing, datum) {\n            bearing = rad(bearing);\n            datum = datum || dataviz.map.datums.WGS84;\n\n            var fromLat = rad(this.lat);\n            var fromLng = rad(this.lng);\n            var dToR = distance / kendo.dataviz.map.datums.WGS84.a;\n\n            var lat = math.asin(sin(fromLat) * cos(dToR) +\n                                cos(fromLat) * sin(dToR) * cos(bearing));\n\n            var lng = fromLng + atan2(sin(bearing) * sin(dToR) * cos(fromLat),\n                                      cos(dToR) - sin(fromLat) * sin(lat));\n\n           return new Location(deg(lat), deg(lng));\n        },\n\n        greatCircleTo: function(dest, datum) {\n            dest = Location.create(dest);\n            datum = datum || dataviz.map.datums.WGS84;\n\n            if (!dest || this.clone().round(8).equals(dest.clone().round(8))) {\n                return {\n                    distance: 0,\n                    azimuthFrom: 0,\n                    azimuthTo: 0\n                };\n            }\n\n            // See http://en.wikipedia.org/wiki/Vincenty's_formulae#Notation\n            // o == sigma\n            // A == alpha\n            var a = datum.a;\n            var b = datum.b;\n            var f = datum.f;\n\n            var L = rad(dest.lng - this.lng);\n\n            var U1 = atan((1 - f) * tan(rad(this.lat)));\n            var sinU1 = sin(U1);\n            var cosU1 = cos(U1);\n\n            var U2 = atan((1 - f) * tan(rad(dest.lat)));\n            var sinU2 = sin(U2);\n            var cosU2 = cos(U2);\n\n            var lambda = L;\n            var prevLambda;\n\n            var i = this.DISTANCE_ITERATIONS;\n            var converged = false;\n\n            var sinLambda;\n            var cosLambda;\n            var sino;\n            var cosA2;\n            var coso;\n            var cos2om;\n            var sigma;\n\n            while (!converged && i-- > 0) {\n                sinLambda = sin(lambda);\n                cosLambda = cos(lambda);\n                sino = math.sqrt(\n                    sqr(cosU2 * sinLambda) + sqr(cosU1 * sinU2 - sinU1 * cosU2 * cosLambda)\n                );\n\n                coso = sinU1 * sinU2 + cosU1 * cosU2 * cosLambda;\n                sigma = atan2(sino, coso);\n\n                var sinA = cosU1 * cosU2 * sinLambda / sino;\n                cosA2 = 1 - sqr(sinA);\n                cos2om = 0;\n                if (cosA2 !== 0) {\n                    cos2om = coso - 2 * sinU1 * sinU2 / cosA2;\n                }\n\n                prevLambda = lambda;\n                var C = f / 16 * cosA2 * (4 + f * (4 - 3 * cosA2));\n                lambda = L + (1 - C) * f * sinA * (\n                    sigma + C * sino * (cos2om + C * coso * (-1 + 2 * sqr(cos2om)))\n                );\n\n                converged = abs(lambda - prevLambda) <= this.DISTANCE_CONVERGENCE;\n            }\n\n            var u2 = cosA2 * (sqr(a) - sqr(b)) / sqr(b);\n            var A = 1 + u2 / 16384 * (4096 + u2 * (-768 + u2 * (320 - 175 * u2)));\n            var B = u2 / 1024 * (256 + u2 * (-128 + u2 * (74 - 47 * u2)));\n            var deltao = B * sino * (cos2om + B / 4 * (\n                coso * (-1 + 2 * sqr(cos2om)) - B / 6 * cos2om * (-3 + 4 * sqr(sino)) * (-3 + 4 * sqr(cos2om))\n            ));\n\n            var azimuthFrom = atan2(cosU2 * sinLambda, cosU1 * sinU2 - sinU1 * cosU2 * cosLambda);\n            var azimuthTo = atan2(cosU1 * sinLambda, -sinU1 * cosU2 + cosU1 * sinU2 * cosLambda);\n\n            return {\n                distance: round(b * A * (sigma - deltao), this.DISTANCE_PRECISION),\n                azimuthFrom: deg(azimuthFrom),\n                azimuthTo: deg(azimuthTo)\n            };\n        }\n    });\n\n    // IE < 9 doesn't allow to override toString on definition\n    Location.fn.toString = function() {\n        return kendo.format(this.FORMAT, this.lat, this.lng);\n    };\n\n    Location.fromLngLat = function(ll) {\n        return new Location(ll[1], ll[0]);\n    };\n\n    Location.fromLatLng = function(ll) {\n        return new Location(ll[0], ll[1]);\n    };\n\n    Location.create = function(a, b) {\n        if (defined(a)) {\n            if (a instanceof Location) {\n                return a.clone();\n            } else if (arguments.length === 1 && a.length === 2) {\n                return Location.fromLatLng(a);\n            } else {\n                return new Location(a, b);\n            }\n        }\n    };\n\n    var Extent = Class.extend({\n        init: function(nw, se) {\n            nw = Location.create(nw);\n            se = Location.create(se);\n\n            if (nw.lng + 180 > se.lng + 180 &&\n                nw.lat + 90 < se.lat + 90) {\n                this.se = nw;\n                this.nw = se;\n            } else {\n                this.se = se;\n                this.nw = nw;\n            }\n        },\n\n        contains: function(loc) {\n            var nw = this.nw,\n                se = this.se,\n                lng = valueOrDefault(loc.lng, loc[1]),\n                lat = valueOrDefault(loc.lat, loc[0]);\n\n            return loc &&\n                   lng + 180 >= nw.lng + 180 &&\n                   lng + 180 <= se.lng + 180 &&\n                   lat + 90 >= se.lat + 90 &&\n                   lat + 90 <= nw.lat + 90;\n        },\n\n        center: function() {\n            var nw = this.nw;\n            var se = this.se;\n\n            var lng = nw.lng + (se.lng - nw.lng) / 2;\n            var lat = nw.lat + (se.lat - nw.lat) / 2;\n            return new Location(lat, lng);\n        },\n\n        containsAny: function(locs) {\n            var result = false;\n            for (var i = 0; i < locs.length; i++) {\n                result = result || this.contains(locs[i]);\n            }\n\n            return result;\n        },\n\n        include: function(loc) {\n            var nw = this.nw,\n                se = this.se,\n                lng = valueOrDefault(loc.lng, loc[1]),\n                lat = valueOrDefault(loc.lat, loc[0]);\n\n            nw.lng = min(nw.lng, lng);\n            nw.lat = max(nw.lat, lat);\n\n            se.lng = max(se.lng, lng);\n            se.lat = min(se.lat, lat);\n        },\n\n        includeAll: function(locs) {\n            for (var i = 0; i < locs.length; i++) {\n                this.include(locs[i]);\n            }\n        },\n\n        edges: function() {\n            var nw = this.nw,\n                se = this.se;\n\n            return { nw: this.nw, ne: new Location(nw.lat, se.lng),\n                    se: this.se, sw: new Location(se.lat, nw.lng) };\n        },\n\n        toArray: function() {\n            var nw = this.nw,\n                se = this.se;\n\n            return [nw, new Location(nw.lat, se.lng),\n                    se, new Location(se.lat, nw.lng)];\n        },\n\n        overlaps: function(extent) {\n            return this.containsAny(extent.toArray()) ||\n                   extent.containsAny(this.toArray());\n        }\n    });\n\n    Extent.World = new Extent([90, -180], [-90, 180]);\n\n    Extent.create = function(a, b) {\n        if (a instanceof Extent) {\n            return a;\n        } else if (a && b) {\n            return new Extent(a, b);\n        } else if (a && a.length === 4 && !b) {\n            return new Extent([a[0], a[1]], [a[2], a[3]]);\n        }\n    };\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            Extent: Extent,\n            Location: Location\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/attribution',[ \"kendo.drawing\" ], f);\n})(function() {\n\n(function() {\n    var kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        template = kendo.template,\n\n        util = kendo.drawing.util,\n        valueOrDefault = util.valueOrDefault,\n        defined = util.defined;\n\n    var Attribution = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this._initOptions(options);\n            this.items = [];\n            this.element.addClass(\"k-widget k-attribution\");\n        },\n\n        options: {\n            name: \"Attribution\",\n            separator: \"&nbsp;|&nbsp;\",\n            itemTemplate: \"#= text #\"\n        },\n\n        filter: function(extent, zoom) {\n            this._extent = extent;\n            this._zoom = zoom;\n            this._render();\n        },\n\n        add: function(item) {\n            if (defined(item)) {\n                if (typeof item === \"string\") {\n                    item = { text: item };\n                }\n\n                this.items.push(item);\n                this._render();\n            }\n        },\n\n        remove: function(text) {\n            var result = [];\n            for (var i = 0; i < this.items.length; i++) {\n                var item = this.items[i];\n                if (item.text !== text) {\n                    result.push(item);\n                }\n            }\n\n            this.items = result;\n\n            this._render();\n        },\n\n        clear: function() {\n            this.items = [];\n            this.element.empty();\n        },\n\n        _render: function() {\n            var result = [];\n            var itemTemplate = template(this.options.itemTemplate);\n\n            for (var i = 0; i < this.items.length; i++) {\n                var item = this.items[i];\n                var text = this._itemText(item);\n                if (text !== \"\") {\n                    result.push(itemTemplate({\n                        text: text\n                    }));\n                }\n            }\n\n            if (result.length > 0) {\n                this.element.empty()\n                    .append(result.join(this.options.separator))\n                    .show();\n            } else {\n                this.element.hide();\n            }\n        },\n\n        _itemText: function(item) {\n            var text = \"\";\n            var inZoomLevel = this._inZoomLevel(item.minZoom, item.maxZoom);\n            var inArea = this._inArea(item.extent);\n\n            if (inZoomLevel && inArea) {\n                text += item.text;\n            }\n\n            return text;\n        },\n\n        _inZoomLevel: function(min, max) {\n            var result = true;\n            min = valueOrDefault(min, -Number.MAX_VALUE);\n            max = valueOrDefault(max, Number.MAX_VALUE);\n\n            result = this._zoom > min && this._zoom < max;\n\n            return result;\n        },\n\n        _inArea: function(area) {\n            var result = true;\n\n            if (area) {\n                result = area.contains(this._extent);\n            }\n\n            return result;\n        }\n    });\n\n    kendo.dataviz.ui.plugin(Attribution);\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/navigator',[ \"kendo.core\" ], f);\n})(function() {\n\n(function($) {\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var keys = kendo.keys;\n\n    var NS = \".kendoNavigator\";\n\n    // Helper functions =======================================================\n    function button(dir) {\n       return kendo.format(\n           '<button class=\"k-button k-rounded-full k-button-flat k-button-flat-base k-icon-button k-navigator-{0}\" aria-label=\"move {0}\">' +\n               '<span class=\"k-button-icon k-icon k-i-arrow-60-{0}\"></span>' +\n           '</button>', dir);\n    }\n\n    var BUTTONS = button(\"up\") + button(\"right\") + button(\"down\") + button(\"left\");\n\n    var Navigator = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this._initOptions(options);\n\n            this.element.addClass(\"k-widget k-navigator\")\n                        .append(BUTTONS)\n                        .on(\"click\" + NS, \".k-button\", this._click.bind(this));\n\n            var parentElement = this.element.parent().closest(\"[\" + kendo.attr(\"role\") + \"]\");\n            this._keyroot = parentElement.length > 0 ? parentElement : this.element;\n            this._tabindex(this._keyroot);\n\n            this._keydown = this._keydown.bind(this);\n            this._keyroot.on(\"keydown\", this._keydown);\n        },\n\n        options: {\n            name: \"Navigator\",\n            panStep: 1\n        },\n\n        events: [\n            \"pan\"\n        ],\n\n        dispose: function() {\n            this._keyroot.off(\"keydown\", this._keydown);\n        },\n\n        _pan: function(x, y) {\n            var panStep = this.options.panStep;\n            this.trigger(\"pan\", {\n                x: x * panStep,\n                y: y * panStep\n            });\n        },\n\n        _click: function(e) {\n            var x = 0;\n            var y = 0;\n            var button = $(e.currentTarget);\n\n            if (button.is(\".k-navigator-up\")) {\n                y = 1;\n            } else if (button.is(\".k-navigator-down\")) {\n                y = -1;\n            } else if (button.is(\".k-navigator-right\")) {\n                x = 1;\n            } else if (button.is(\".k-navigator-left\")) {\n                x = -1;\n            }\n\n            this._pan(x, y);\n            e.preventDefault();\n        },\n\n        _keydown: function(e) {\n            switch (e.which) {\n                case keys.UP:\n                    this._pan(0, 1);\n                    e.preventDefault();\n                    break;\n\n                case keys.DOWN:\n                    this._pan(0, -1);\n                    e.preventDefault();\n                    break;\n\n                case keys.RIGHT:\n                    this._pan(1, 0);\n                    e.preventDefault();\n                    break;\n\n                case keys.LEFT:\n                    this._pan(-1, 0);\n                    e.preventDefault();\n                    break;\n            }\n        }\n    });\n\n    // Exports ================================================================\n    kendo.dataviz.ui.plugin(Navigator);\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n(function(f, define) {\n    define('dataviz/map/zoom',[ \"kendo.core\" ], f);\n})(function() {\n\n(function($) {\n    var kendo = window.kendo;\n    var Widget = kendo.ui.Widget;\n    var keys = kendo.keys;\n\n    // Helper functions =======================================================\n    function button(dir, iconClass) {\n       return kendo.format(\n           '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-zoom-{0}\" title=\"zoom-{0}\" aria-label=\"zoom-{0}\"><span class=\"k-button-icon k-icon {1}\"></span></button>',\n           dir, iconClass);\n    }\n\n    var NS = \".kendoZoomControl\";\n    var BUTTONS = button(\"in\", \"k-i-plus\") + button(\"out\", \"k-i-minus\");\n\n    var PLUS = 187;\n    var MINUS = 189;\n    var FF_PLUS = 61;\n    var FF_MINUS = 173;\n\n\n    var ZoomControl = Widget.extend({\n        init: function(element, options) {\n            Widget.fn.init.call(this, element, options);\n            this._initOptions(options);\n\n            this.element.addClass(\"k-widget k-zoom-control k-button-group k-group-horizontal\")\n                        .append(BUTTONS)\n                        .on(\"click\" + NS, \".k-button\", this._click.bind(this));\n\n            var parentElement = this.element.parent().closest(\"[\" + kendo.attr(\"role\") + \"]\");\n            this._keyroot = parentElement.length > 0 ? parentElement : this.element;\n\n            this._tabindex(this._keyroot);\n\n            this._keydown = this._keydown.bind(this);\n            this._keyroot.on(\"keydown\", this._keydown);\n        },\n\n        options: {\n            name: \"ZoomControl\",\n            zoomStep: 1\n        },\n\n        events: [\n            \"change\"\n        ],\n\n        _change: function(dir) {\n            var zoomStep = this.options.zoomStep;\n            this.trigger(\"change\", {\n                delta: dir * zoomStep\n            });\n        },\n\n        _click: function(e) {\n            var button = $(e.currentTarget);\n            var dir = 1;\n\n            if (button.is(\".k-zoom-out\")) {\n                dir = -1;\n            }\n\n            this._change(dir);\n            e.preventDefault();\n        },\n\n        _keydown: function(e) {\n            switch (e.which) {\n                case keys.NUMPAD_PLUS:\n                case PLUS:\n                case FF_PLUS:\n                    this._change(1);\n                    break;\n\n                case keys.NUMPAD_MINUS:\n                case MINUS:\n                case FF_MINUS:\n                    this._change(-1);\n                    break;\n            }\n        }\n    });\n\n\n    // Exports ================================================================\n    kendo.dataviz.ui.plugin(ZoomControl);\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/crs',[ \"./location\", \"kendo.drawing\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var math = Math,\n        atan = math.atan,\n        exp = math.exp,\n        pow = math.pow,\n        sin = math.sin,\n        log = math.log,\n        tan = math.tan,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n        Point = g.Point,\n\n        map = dataviz.map,\n        Location = map.Location,\n\n        util = kendo.drawing.util,\n        rad = util.rad,\n        deg = util.deg,\n        limit = util.limitValue;\n\n    // Constants ==============================================================\n    var PI = math.PI,\n        PI_DIV_2 = PI / 2,\n        PI_DIV_4 = PI / 4,\n        DEG_TO_RAD = PI / 180;\n\n    // Coordinate reference systems ===========================================\n    var WGS84 = {\n        a: 6378137, // Semi-major radius\n        b: 6356752.314245179, // Semi-minor radius\n        f: 0.0033528106647474805, // Flattening\n        e: 0.08181919084262149 // Eccentricity\n    };\n\n    // WGS 84 / World Mercator\n    var Mercator = Class.extend({\n        init: function(options) {\n            this._initOptions(options);\n        },\n\n        MAX_LNG: 180,\n        MAX_LAT: 85.0840590501,\n        INVERSE_ITERATIONS: 15,\n        INVERSE_CONVERGENCE: 1e-12,\n\n        options: {\n            centralMeridian: 0,\n            datum: WGS84\n        },\n\n        forward: function(loc, clamp) {\n            var proj = this,\n                options = proj.options,\n                datum = options.datum,\n                r = datum.a,\n                lng0 = options.centralMeridian,\n                lat = limit(loc.lat, -proj.MAX_LAT, proj.MAX_LAT),\n                lng = clamp ? limit(loc.lng, -proj.MAX_LNG, proj.MAX_LNG) : loc.lng,\n                x = rad(lng - lng0) * r,\n                y = proj._projectLat(lat);\n\n            return new Point(x, y);\n        },\n\n        _projectLat: function(lat) {\n            var datum = this.options.datum,\n                ecc = datum.e,\n                r = datum.a,\n                y = rad(lat),\n                ts = tan(PI_DIV_4 + y / 2),\n                con = ecc * sin(y),\n                p = pow((1 - con) / (1 + con), ecc / 2);\n\n            // See:\n            // http://en.wikipedia.org/wiki/Mercator_projection#Generalization_to_the_ellipsoid\n            return r * log(ts * p);\n        },\n\n        inverse: function(point, clamp) {\n            var proj = this,\n                options = proj.options,\n                datum = options.datum,\n                r = datum.a,\n                lng0 = options.centralMeridian,\n                lng = point.x / (DEG_TO_RAD * r) + lng0,\n                lat = limit(proj._inverseY(point.y), -proj.MAX_LAT, proj.MAX_LAT);\n\n            if (clamp) {\n                lng = limit(lng, -proj.MAX_LNG, proj.MAX_LNG);\n            }\n\n            return new Location(lat, lng);\n        },\n\n        _inverseY: function(y) {\n            var proj = this,\n                datum = proj.options.datum,\n                r = datum.a,\n                ecc = datum.e,\n                ecch = ecc / 2,\n                ts = exp(-y / r),\n                phi = PI_DIV_2 - 2 * atan(ts),\n                i;\n\n            for (i = 0; i <= proj.INVERSE_ITERATIONS; i++) {\n                var con = ecc * sin(phi),\n                    p = pow((1 - con) / (1 + con), ecch),\n                    dphi = PI_DIV_2 - 2 * atan(ts * p) - phi;\n\n                phi += dphi;\n\n                if (math.abs(dphi) <= proj.INVERSE_CONVERGENCE) {\n                    break;\n                }\n            }\n\n            return deg(phi);\n        }\n    });\n\n    // WGS 84 / Pseudo-Mercator\n    // Used by Google Maps, Bing, OSM, etc.\n    // Spherical projection of ellipsoidal coordinates.\n    var SphericalMercator = Mercator.extend({\n        MAX_LAT: 85.0511287798,\n\n        _projectLat: function(lat) {\n            var r = this.options.datum.a,\n                y = rad(lat),\n                ts = tan(PI_DIV_4 + y / 2);\n\n            return r * log(ts);\n        },\n\n        _inverseY: function(y) {\n            var r = this.options.datum.a,\n                ts = exp(-y / r);\n\n            return deg(PI_DIV_2 - (2 * atan(ts)));\n        }\n    });\n\n    var Equirectangular = Class.extend({\n        forward: function(loc) {\n            return new Point(loc.lng, loc.lat);\n        },\n\n        inverse: function(point) {\n            return new Location(point.y, point.x);\n        }\n    });\n\n    // TODO: Better (less cryptic name) for this class(es)\n    var EPSG3857 = Class.extend({\n        init: function() {\n            var crs = this,\n                proj = crs._proj = new SphericalMercator();\n\n            var c = this.c = 2 * PI * proj.options.datum.a;\n\n            // Scale circumference to 1, mirror Y and shift origin to top left\n            this._tm = g.transform().translate(0.5, 0.5).scale(1 / c, -1 / c);\n\n            // Inverse transform matrix\n            this._itm = g.transform().scale(c, -c).translate(-0.5, -0.5);\n        },\n\n        // Location <-> Point (screen coordinates for a given scale)\n        toPoint: function(loc, scale, clamp) {\n            var point = this._proj.forward(loc, clamp);\n\n            return point\n                .transform(this._tm)\n                .scale(scale || 1);\n        },\n\n        toLocation: function(point, scale, clamp) {\n            point = point\n                .clone()\n                .scale(1 / (scale || 1))\n                .transform(this._itm);\n\n            return this._proj.inverse(point, clamp);\n        }\n    });\n\n    var EPSG3395 = Class.extend({\n        init: function() {\n            this._proj = new Mercator();\n        },\n\n        toPoint: function(loc) {\n            return this._proj.forward(loc);\n        },\n\n        toLocation: function(point) {\n            return this._proj.inverse(point);\n        }\n    });\n\n    // WGS 84\n    var EPSG4326 = Class.extend({\n        init: function() {\n            this._proj = new Equirectangular();\n        },\n\n        toPoint: function(loc) {\n            return this._proj.forward(loc);\n        },\n\n        toLocation: function(point) {\n            return this._proj.inverse(point);\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            crs: {\n                EPSG3395: EPSG3395,\n                EPSG3857: EPSG3857,\n                EPSG4326: EPSG4326\n            },\n            datums: {\n                WGS84: WGS84\n            },\n            projections: {\n                Equirectangular: Equirectangular,\n                Mercator: Mercator,\n                SphericalMercator: SphericalMercator\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/base',[ \"kendo.core\", \"../location\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var kendo = window.kendo,\n        Class = kendo.Class,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        Extent = dataviz.map.Extent,\n\n        util = kendo.drawing.util,\n        defined = util.defined;\n\n    // Implementation =========================================================\n    var Layer = Class.extend({\n        init: function(map, options) {\n            this._initOptions(options);\n            this.map = map;\n\n            this.element = $(\"<div class='k-layer'></div>\")\n               .css({\n                   \"zIndex\": this.options.zIndex,\n                   \"opacity\": this.options.opacity\n               })\n               .appendTo(map.scrollElement);\n\n            this._beforeReset = this._beforeReset.bind(this);\n            this._reset = this._reset.bind(this);\n            this._resize = this._resize.bind(this);\n            this._panEnd = this._panEnd.bind(this);\n            this._activate();\n\n            this._updateAttribution();\n        },\n\n        destroy: function() {\n            this._deactivate();\n        },\n\n        show: function() {\n            this.reset();\n            this._activate();\n            this._applyExtent(true);\n        },\n\n        hide: function() {\n            this._deactivate();\n            this._setVisibility(false);\n        },\n\n        reset: function() {\n            this._beforeReset();\n            this._reset();\n        },\n\n        _reset: function() {\n            this._applyExtent();\n        },\n\n        _beforeReset: $.noop,\n\n        _resize: $.noop,\n\n        _panEnd: function() {\n            this._applyExtent();\n        },\n\n        _applyExtent: function() {\n            var options = this.options;\n\n            var zoom = this.map.zoom();\n            var matchMinZoom = !defined(options.minZoom) || zoom >= options.minZoom;\n            var matchMaxZoom = !defined(options.maxZoom) || zoom <= options.maxZoom;\n\n            var extent = Extent.create(options.extent);\n            var inside = !extent || extent.overlaps(this.map.extent());\n\n            this._setVisibility(matchMinZoom && matchMaxZoom && inside);\n        },\n\n        _setVisibility: function(visible) {\n            this.element.css(\"display\", visible ? \"\" : \"none\");\n        },\n\n        _activate: function() {\n            var map = this.map;\n            this._deactivate();\n            map.bind(\"beforeReset\", this._beforeReset);\n            map.bind(\"reset\", this._reset);\n            map.bind(\"resize\", this._resize);\n            map.bind(\"panEnd\", this._panEnd);\n        },\n\n        _deactivate: function() {\n            var map = this.map;\n            map.unbind(\"beforeReset\", this._beforeReset);\n            map.unbind(\"reset\", this._reset);\n            map.unbind(\"resize\", this._resize);\n            map.unbind(\"panEnd\", this._panEnd);\n        },\n\n        _updateAttribution: function() {\n            var attr = this.map.attribution;\n\n            if (attr) {\n                attr.add(this.options.attribution);\n            }\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                Layer: Layer\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/shape',[\"./base\", \"../location\"], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var kendo = window.kendo,\n        Class = kendo.Class,\n        DataSource = kendo.data.DataSource,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n\n        d = kendo.drawing,\n        Group = d.Group,\n\n        last = d.util.last,\n        defined = d.util.defined,\n\n        map = dataviz.map,\n        Location = map.Location,\n        Layer = map.layers.Layer;\n\n    // Implementation =========================================================\n    var ShapeLayer = Layer.extend({\n        init: function(map, options) {\n\n            this._pan = this._pan.bind(this);\n\n            Layer.fn.init.call(this, map, options);\n\n            this.surface = d.Surface.create(this.element, {\n                width: map.scrollElement.width(),\n                height: map.scrollElement.height()\n            });\n\n            this._initRoot();\n\n            this.movable = new kendo.ui.Movable(this.surface.element);\n            this._markers = [];\n\n            this._click = this._handler(\"shapeClick\");\n            this.surface.bind(\"click\", this._click);\n\n            this._mouseenter = this._handler(\"shapeMouseEnter\");\n            this.surface.bind(\"mouseenter\", this._mouseenter);\n\n            this._mouseleave = this._handler(\"shapeMouseLeave\");\n            this.surface.bind(\"mouseleave\", this._mouseleave);\n\n            this._initDataSource();\n        },\n\n        options: {\n            autoBind: true\n        },\n\n        destroy: function() {\n            Layer.fn.destroy.call(this);\n\n            this.surface.destroy();\n            this.dataSource.unbind(\"change\", this._dataChange);\n        },\n\n        setDataSource: function(dataSource) {\n            if (this.dataSource) {\n                this.dataSource.unbind(\"change\", this._dataChange);\n            }\n\n            this.dataSource = kendo.data.DataSource.create(dataSource);\n            this.dataSource.bind(\"change\", this._dataChange);\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _reset: function() {\n            Layer.fn._reset.call(this);\n            this._translateSurface();\n\n            if (this._data) {\n                this._load(this._data);\n            }\n        },\n\n        _initRoot: function() {\n            this._root = new Group();\n            this.surface.draw(this._root);\n        },\n\n        _beforeReset: function() {\n            this.surface.clear();\n            this._initRoot();\n        },\n\n        _resize: function() {\n            this.surface.size(this.map.size());\n        },\n\n        _initDataSource: function() {\n            var dsOptions = this.options.dataSource;\n            this._dataChange = this._dataChange.bind(this);\n            this.dataSource = DataSource\n                .create(dsOptions)\n                .bind(\"change\", this._dataChange);\n\n            if (dsOptions && this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _dataChange: function(e) {\n            this._data = e.sender.view();\n            this._load(this._data);\n        },\n\n        _load: function(data) {\n            this._clearMarkers();\n\n            if (!this._loader) {\n                this._loader = new GeoJSONLoader(this.map, this.options.style, this);\n            }\n\n            var container = new Group();\n            for (var i = 0; i < data.length; i++) {\n                var shape = this._loader.parse(data[i]);\n                if (shape) {\n                    container.append(shape);\n                }\n            }\n\n            this._root.clear();\n            this._root.append(container);\n        },\n\n        shapeCreated: function(shape) {\n            var cancelled = false;\n            if (shape instanceof d.Circle) {\n                cancelled = defined(this._createMarker(shape));\n            }\n\n            if (!cancelled) {\n                var args = { layer: this, shape: shape };\n                cancelled = this.map.trigger(\"shapeCreated\", args);\n            }\n\n            return cancelled;\n        },\n\n        featureCreated: function(e) {\n            e.layer = this;\n            this.map.trigger(\"shapeFeatureCreated\", e);\n        },\n\n        _createMarker: function(shape) {\n            var marker = this.map.markers.bind({\n                location: shape.location\n            }, shape.dataItem);\n\n            if (marker) {\n                this._markers.push(marker);\n            }\n\n            return marker;\n        },\n\n        _clearMarkers: function() {\n            for (var i = 0; i < this._markers.length; i++) {\n                this.map.markers.remove(this._markers[i]);\n            }\n            this._markers = [];\n        },\n\n        _pan: function() {\n            if (!this._panning) {\n                this._panning = true;\n                this.surface.suspendTracking();\n            }\n        },\n\n        _panEnd: function(e) {\n            Layer.fn._panEnd.call(this, e);\n            this._translateSurface();\n            this.surface.resumeTracking();\n            this._panning = false;\n        },\n\n        _translateSurface: function() {\n            var map = this.map;\n            var nw = map.locationToView(map.extent().nw);\n\n            if (this.surface.translate) {\n                this.surface.translate(nw);\n                this.movable.moveTo({ x: nw.x, y: nw.y });\n            }\n        },\n\n        _handler: function(event) {\n            var layer = this;\n            return function(e) {\n                if (e.element) {\n                    var args = {\n                        layer: layer,\n                        shape: e.element,\n                        originalEvent: e.originalEvent\n                    };\n\n                    layer.map.trigger(event, args);\n                }\n            };\n        },\n\n        _activate: function() {\n            Layer.fn._activate.call(this);\n\n            this.map.bind(\"pan\", this._pan);\n        },\n\n        _deactivate: function() {\n            Layer.fn._deactivate.call(this);\n\n            this.map.unbind(\"pan\", this._pan);\n        }\n    });\n\n    var GeoJSONLoader = Class.extend({\n        init: function(locator, defaultStyle, observer) {\n            this.observer = observer;\n            this.locator = locator;\n            this.style = defaultStyle;\n        },\n\n        parse: function(item) {\n            var root = new Group();\n            var unwrap = true;\n\n            if (item.type === \"Feature\") {\n                unwrap = false;\n                this._loadGeometryTo(root, item.geometry, item);\n                this._featureCreated(root, item);\n            } else {\n                this._loadGeometryTo(root, item, item);\n            }\n\n            if (unwrap && root.children.length < 2) {\n                root = root.children[0];\n            }\n\n            return root;\n        },\n\n        _shapeCreated: function(shape) {\n            var cancelled = false;\n\n            if (this.observer && this.observer.shapeCreated) {\n                cancelled = this.observer.shapeCreated(shape);\n            }\n\n            return cancelled;\n        },\n\n        _featureCreated: function(group, dataItem) {\n            if (this.observer && this.observer.featureCreated) {\n                this.observer.featureCreated({\n                    group: group,\n                    dataItem: dataItem,\n                    properties: dataItem.properties\n                });\n            }\n        },\n\n        _loadGeometryTo: function(container, geometry, dataItem) {\n            var coords = geometry.coordinates;\n            var i;\n            var path;\n\n            switch (geometry.type) {\n                case \"LineString\":\n                    path = this._loadPolygon(container, [coords], dataItem);\n                    this._setLineFill(path);\n                    break;\n\n                case \"MultiLineString\":\n                    for (i = 0; i < coords.length; i++) {\n                        path = this._loadPolygon(container, [coords[i]], dataItem);\n                        this._setLineFill(path);\n                    }\n                    break;\n\n                case \"Polygon\":\n                    this._loadPolygon(container, coords, dataItem);\n                    break;\n\n                case \"MultiPolygon\":\n                    for (i = 0; i < coords.length; i++) {\n                        this._loadPolygon(container, coords[i], dataItem);\n                    }\n                    break;\n\n                case \"Point\":\n                    this._loadPoint(container, coords, dataItem);\n                    break;\n\n                case \"MultiPoint\":\n                    for (i = 0; i < coords.length; i++) {\n                        this._loadPoint(container, coords[i], dataItem);\n                    }\n                    break;\n            }\n        },\n\n        _setLineFill: function(path) {\n            var segments = path.segments;\n            if (segments.length < 4 || !segments[0].anchor().equals(last(segments).anchor())) {\n                path.options.fill = null;\n            }\n        },\n\n        _loadShape: function(container, shape) {\n            if (!this._shapeCreated(shape)) {\n                container.append(shape);\n            }\n\n            return shape;\n        },\n\n        _loadPolygon: function(container, rings, dataItem) {\n            var shape = this._buildPolygon(rings);\n            shape.dataItem = dataItem;\n\n            return this._loadShape(container, shape);\n        },\n\n        _buildPolygon: function(rings) {\n            var type = rings.length > 1 ? d.MultiPath : d.Path;\n            var path = new type(this.style);\n\n            for (var i = 0; i < rings.length; i++) {\n                for (var j = 0; j < rings[i].length; j++) {\n                    var point = this.locator.locationToView(\n                        Location.fromLngLat(rings[i][j])\n                    );\n\n                    if (j === 0) {\n                        path.moveTo(point.x, point.y);\n                    } else {\n                        path.lineTo(point.x, point.y);\n                    }\n                }\n            }\n\n            return path;\n        },\n\n        _loadPoint: function(container, coords, dataItem) {\n            var location = Location.fromLngLat(coords);\n            var point = this.locator.locationToView(location);\n\n            var circle = new g.Circle(point, 10);\n            var shape = new d.Circle(circle, this.style);\n            shape.dataItem = dataItem;\n            shape.location = location;\n\n            return this._loadShape(container, shape);\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(kendo.data, {\n        schemas: {\n            geojson: {\n                type: \"json\",\n                data: function(data) {\n                    if (data.type === \"FeatureCollection\") {\n                        return data.features;\n                    }\n\n                    if (data.type === \"GeometryCollection\") {\n                        return data.geometries;\n                    }\n\n                    return data;\n                }\n            }\n        },\n        transports: {\n            geojson: {\n                read: {\n                    dataType: \"json\"\n                }\n            }\n        }\n    });\n\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                shape: ShapeLayer,\n                ShapeLayer: ShapeLayer\n            },\n            GeoJSONLoader: GeoJSONLoader\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/bubble',[\"./shape\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var kendo = window.kendo,\n        getter = kendo.getter,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n        d = kendo.drawing,\n\n        util = d.util,\n        defined = util.defined,\n\n        map = dataviz.map,\n        Location = map.Location,\n        ShapeLayer = map.layers.ShapeLayer;\n\n    // Implementation =========================================================\n    var BubbleLayer = ShapeLayer.extend({\n        options: {\n            autoBind: true,\n            locationField: \"location\",\n            valueField: \"value\",\n            minSize: 0,\n            maxSize: 100,\n            scale: \"sqrt\",\n            symbol: \"circle\"\n        },\n\n        _load: function(data) {\n            this.surface.clear();\n\n            if (data.length === 0) {\n                return;\n            }\n\n            var opt = this.options;\n            var getValue = getter(opt.valueField);\n\n            data = data.slice(0);\n            data.sort(function(a, b) {\n                return getValue(b) - getValue(a);\n            });\n\n            var scaleType = this._scaleType();\n            var scale;\n            for (var i = 0; i < data.length; i++) {\n                var dataItem = data[i];\n                var location = getter(opt.locationField)(dataItem);\n                var value = getter(opt.valueField)(dataItem);\n\n                if (defined(location) && defined(value)) {\n                    if (!scale) {\n                        scale = new scaleType([0, value], [opt.minSize, opt.maxSize]);\n                    }\n\n                    location = Location.create(location);\n                    var center = this.map.locationToView(location);\n                    var size = scale.map(value);\n\n                    var symbol = this._createSymbol({\n                        center: center,\n                        size: size,\n                        style: opt.style,\n                        dataItem: dataItem,\n                        location: location\n                    });\n\n                    symbol.dataItem = dataItem;\n                    symbol.location = location;\n                    symbol.value = value;\n\n                    this._drawSymbol(symbol);\n                }\n            }\n        },\n\n        _scaleType: function() {\n            var scale = this.options.scale;\n\n            if (kendo.isFunction(scale)) {\n                return scale;\n            }\n\n            return dataviz.map.scales[scale];\n        },\n\n        _createSymbol: function(args) {\n            var symbol = this.options.symbol;\n            if (!kendo.isFunction(symbol)) {\n                symbol = dataviz.map.symbols[symbol];\n            }\n\n            return symbol(args);\n        },\n\n        _drawSymbol: function(shape) {\n            var args = { layer: this, shape: shape };\n            var cancelled = this.map.trigger(\"shapeCreated\", args);\n            if (!cancelled) {\n                this.surface.draw(shape);\n            }\n        }\n    });\n\n    var SqrtScale = kendo.Class.extend({\n        init: function(domain, range) {\n            this._domain = domain;\n            this._range = range;\n\n            var domainRange = Math.sqrt(domain[1]) - Math.sqrt(domain[0]);\n            var outputRange = range[1] - range[0];\n            this._ratio = outputRange / domainRange;\n        },\n\n        map: function(value) {\n            var rel = (Math.sqrt(value) - Math.sqrt(this._domain[0])) * this._ratio;\n            return this._range[0] + rel;\n        }\n    });\n\n    var Symbols = {\n        circle: function(args) {\n            var geo = new g.Circle(args.center, args.size / 2);\n            return new d.Circle(geo, args.style);\n        },\n\n        square: function(args) {\n            var path = new d.Path(args.style);\n            var halfSize = args.size / 2;\n            var center = args.center;\n\n            path.moveTo(center.x - halfSize, center.y - halfSize)\n                .lineTo(center.x + halfSize, center.y - halfSize)\n                .lineTo(center.x + halfSize, center.y + halfSize)\n                .lineTo(center.x - halfSize, center.y + halfSize)\n                .close();\n\n            return path;\n        }\n    };\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                bubble: BubbleLayer,\n                BubbleLayer: BubbleLayer\n            },\n            scales: {\n                sqrt: SqrtScale\n            },\n            symbols: Symbols\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/tile',[ \"./base\", \"../location\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var math = Math,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n        template = kendo.template,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        g = kendo.geometry,\n        Point = g.Point,\n\n        Layer = dataviz.map.layers.Layer,\n\n        util = kendo.util,\n        renderSize = util.renderSize,\n\n        drawingUtil = kendo.drawing.util,\n        round = drawingUtil.round,\n        limit = drawingUtil.limitValue;\n\n    // Image tile layer =============================================================\n    var TileLayer = Layer.extend({\n        init: function(map, options) {\n            Layer.fn.init.call(this, map, options);\n\n            if (typeof this.options.subdomains === \"string\") {\n                this.options.subdomains = this.options.subdomains.split(\"\");\n            }\n\n            var viewType = this._viewType();\n            this._view = new viewType(this.element, this.options);\n        },\n\n        destroy: function() {\n            Layer.fn.destroy.call(this);\n\n            this._view.destroy();\n            this._view = null;\n        },\n\n        _beforeReset: function() {\n            var map = this.map;\n            var origin = map.locationToLayer(map.extent().nw).round();\n            this._view.viewOrigin(origin);\n        },\n\n        _reset: function(e) {\n            var tileTitle;\n\n            if (e) {\n                tileTitle = e.tileTitle;\n            } else {\n                tileTitle = \"\";\n            }\n\n            Layer.fn._reset.call(this);\n            this._updateView();\n            this._view.reset(tileTitle);\n        },\n\n        _viewType: function() {\n            return TileView;\n        },\n\n        _activate: function() {\n            Layer.fn._activate.call(this);\n\n            if (!kendo.support.mobileOS) {\n                if (!this._pan) {\n                    this._pan = kendo.throttle(\n                        this._render.bind(this),\n                        100\n                    );\n                }\n\n                this.map.bind(\"pan\", this._pan);\n            }\n        },\n\n        _deactivate: function() {\n            Layer.fn._deactivate.call(this);\n\n            if (this._pan) {\n                this.map.unbind(\"pan\", this._pan);\n            }\n        },\n\n        _updateView: function() {\n            var view = this._view,\n                map = this.map,\n                extent = map.extent(),\n                extentToPoint = {\n                    nw: map.locationToLayer(extent.nw).round(),\n                    se: map.locationToLayer(extent.se).round()\n                };\n\n            view.center(map.locationToLayer(map.center()));\n            view.extent(extentToPoint);\n            view.zoom(map.zoom());\n        },\n\n        _resize: function() {\n            this._render();\n        },\n\n        _panEnd: function(e) {\n            Layer.fn._panEnd.call(this, e);\n            this._render();\n        },\n\n        _render: function() {\n            this._updateView();\n            this._view.render();\n        }\n    });\n\n    var TileView = Class.extend({\n        init: function(element, options) {\n            this.element = element;\n            this._initOptions(options);\n\n            this.pool = new TilePool();\n        },\n\n        options: {\n            tileSize: 256,\n            subdomains: [\"a\", \"b\", \"c\"],\n            urlTemplate: \"\"\n        },\n\n        center: function(center) {\n            this._center = center;\n        },\n\n        extent: function(extent) {\n            this._extent = extent;\n        },\n\n        viewOrigin: function(origin) {\n            this._viewOrigin = origin;\n        },\n\n        zoom: function(zoom) {\n            this._zoom = zoom;\n        },\n\n        pointToTileIndex: function(point) {\n            return new Point(\n                math.floor(point.x / this.options.tileSize),\n                math.floor(point.y / this.options.tileSize)\n            );\n        },\n\n        tileCount: function() {\n            var size = this.size(),\n                firstTileIndex = this.pointToTileIndex(this._extent.nw),\n                nw = this._extent.nw,\n                point = this.indexToPoint(firstTileIndex).translate(-nw.x, -nw.y);\n\n            return {\n                x: math.ceil((math.abs(point.x) + size.width) / this.options.tileSize),\n                y: math.ceil((math.abs(point.y) + size.height) / this.options.tileSize)\n            };\n        },\n\n        size: function() {\n            var nw = this._extent.nw,\n                se = this._extent.se,\n                diff = se.clone().translate(-nw.x, -nw.y);\n\n            return {\n                width: diff.x,\n                height: diff.y\n            };\n        },\n\n        indexToPoint: function(index) {\n            var x = index.x, y = index.y;\n\n            return new Point(\n                x * this.options.tileSize,\n                y * this.options.tileSize\n            );\n        },\n\n        subdomainText: function() {\n            var subdomains = this.options.subdomains;\n\n            return subdomains[this.subdomainIndex++ % subdomains.length];\n        },\n\n        destroy: function() {\n            this.element.empty();\n            this.pool.empty();\n        },\n\n        reset: function(tileTitle) {\n            this._tileTitle = tileTitle;\n            this.pool.reset();\n            this.subdomainIndex = 0;\n            this.render();\n        },\n\n        render: function() {\n            var size = this.tileCount(),\n                firstTileIndex = this.pointToTileIndex(this._extent.nw),\n                tile, x, y;\n\n            for (x = 0; x < size.x; x++) {\n                for (y = 0; y < size.y; y++) {\n                    tile = this.createTile({\n                        x: firstTileIndex.x + x,\n                        y: firstTileIndex.y + y\n                    });\n\n                    if (!tile.visible) {\n                        tile.show();\n                    }\n                }\n            }\n        },\n\n        createTile: function(currentIndex) {\n            var options = this.tileOptions(currentIndex);\n            var tile = this.pool.get(this._center, options);\n            if (tile.element.parent().length === 0) {\n                this.element.append(tile.element);\n            }\n\n            return tile;\n        },\n\n        tileOptions: function(currentIndex) {\n            var index = this.wrapIndex(currentIndex),\n                point = this.indexToPoint(currentIndex),\n                origin = this._viewOrigin,\n                offset = point.clone().translate(-origin.x, -origin.y);\n\n            return {\n                index: index,\n                currentIndex: currentIndex,\n                point: point,\n                offset: roundPoint(offset),\n                zoom: this._zoom,\n                size: this.options.tileSize,\n                subdomain: this.subdomainText(),\n                urlTemplate: this.options.urlTemplate,\n                errorUrlTemplate: this.options.errorUrlTemplate,\n                tileTitle: this._tileTitle\n            };\n        },\n\n        wrapIndex: function(index) {\n            var boundary = math.pow(2, this._zoom);\n            return {\n                x: this.wrapValue(index.x, boundary),\n                y: limit(index.y, 0, boundary - 1)\n            };\n        },\n\n        wrapValue: function(value, boundary) {\n            var remainder = (math.abs(value) % boundary);\n            if (value >= 0) {\n                value = remainder;\n            } else {\n                value = boundary - (remainder === 0 ? boundary : remainder);\n            }\n\n            return value;\n        }\n    });\n\n    var ImageTile = Class.extend({\n        init: function(id, options) {\n            this.id = id;\n            this.visible = true;\n\n            this._initOptions(options);\n            this.createElement();\n            this.show();\n        },\n\n        options: {\n            urlTemplate: \"\",\n            errorUrlTemplate: \"\"\n        },\n\n        createElement: function() {\n            this.element = $(\"<img style='position: absolute; display: block;' alt='\" + this.options.tileTitle + \"' />\")\n                            .css({ width: this.options.size, height: this.options.size })\n                            .on(\"error\", (function(e) {\n                                if (this.errorUrl()) {\n                                    e.target.setAttribute(\"src\", this.errorUrl());\n                                } else {\n                                    e.target.removeAttribute(\"src\");\n                                }\n                            }).bind(this));\n        },\n\n        show: function() {\n            var element = this.element[0];\n            element.style.top = renderSize(this.options.offset.y);\n            element.style.left = renderSize(this.options.offset.x);\n\n            var url = this.url();\n            if (url) {\n                element.setAttribute(\"src\", url);\n            }\n\n            element.style.visibility = \"visible\";\n            this.visible = true;\n        },\n\n        hide: function() {\n            this.element[0].style.visibility = \"hidden\";\n            this.visible = false;\n        },\n\n        url: function() {\n            var urlResult = template(this.options.urlTemplate);\n\n            return urlResult(this.urlOptions());\n        },\n\n        errorUrl: function() {\n            var urlResult = template(this.options.errorUrlTemplate);\n\n            return urlResult(this.urlOptions());\n        },\n\n        urlOptions: function() {\n            var options = this.options;\n            return {\n                zoom: options.zoom,\n                subdomain: options.subdomain,\n                z: options.zoom,\n                x: options.index.x,\n                y: options.index.y,\n                s: options.subdomain,\n                quadkey: options.quadkey,\n                q: options.quadkey,\n                culture: options.culture,\n                c: options.culture\n            };\n        },\n\n        destroy: function() {\n            if (this.element) {\n                this.element.remove();\n                this.element = null;\n            }\n        }\n    });\n\n    var TilePool = Class.extend({\n        init: function() {\n            this._items = [];\n        },\n\n        options: {\n            maxSize: 100\n        },\n\n        get: function(center, options) {\n            if (this._items.length >= this.options.maxSize) {\n                this._remove(center);\n            }\n\n            return this._create(options);\n        },\n\n        empty: function() {\n            var items = this._items;\n            for (var i = 0; i < items.length; i++) {\n                items[i].destroy();\n            }\n\n            this._items = [];\n        },\n\n        reset: function() {\n            var items = this._items;\n            for (var i = 0; i < items.length; i++) {\n                items[i].hide();\n            }\n        },\n\n        _create: function(options) {\n            var items = this._items;\n            var tile;\n\n            // Build an unique token for the image\n            // This normally would be the URL, but we don't care about subdomains\n            var id = util.hashKey(\n                options.point.toString() +\n                options.offset.toString() +\n                options.zoom +\n                options.urlTemplate\n            );\n\n            for (var i = 0; i < items.length; i++) {\n                if (items[i].id === id) {\n                    tile = items[i];\n                    break;\n                }\n            }\n\n            if (tile) {\n                tile.show();\n            } else {\n                tile = new ImageTile(id, options);\n                this._items.push(tile);\n            }\n\n            return tile;\n        },\n\n        _remove: function(center) {\n            var items = this._items;\n            var maxDist = -1;\n            var index = -1;\n\n            for (var i = 0; i < items.length; i++) {\n                var dist = items[i].options.point.distanceTo(center);\n                if (dist > maxDist && !items[i].visible) {\n                    index = i;\n                    maxDist = dist;\n                }\n            }\n\n            if (index !== -1) {\n                items[index].destroy();\n                items.splice(index, 1);\n            }\n        }\n    });\n\n    // Methods ================================================================\n    function roundPoint(point) {\n        return new Point(round(point.x), round(point.y));\n    }\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                tile: TileLayer,\n                TileLayer: TileLayer,\n\n                ImageTile: ImageTile,\n                TilePool: TilePool,\n                TileView: TileView\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/bing',[ \"./tile\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var kendo = window.kendo,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n        defined = kendo.drawing.util.defined,\n\n        Extent = dataviz.map.Extent,\n        Location = dataviz.map.Location,\n        TileLayer = dataviz.map.layers.TileLayer,\n        TileView = dataviz.map.layers.TileView;\n\n    // Bing tile layer =============================================================\n    var BingLayer = TileLayer.extend({\n        init: function(map, options) {\n            this.options.baseUrl =\n                this._scheme() +\n                \"://dev.virtualearth.net/REST/v1/Imagery/Metadata/\";\n\n            TileLayer.fn.init.call(this, map, options);\n\n            this._onMetadata = this._onMetadata.bind(this);\n            this._fetchMetadata();\n        },\n\n        options: {\n            imagerySet: \"road\"\n        },\n\n        _fetchMetadata: function() {\n            var options = this.options;\n\n            if (!options.key) {\n                throw new Error(\"Bing tile layer: API key is required\");\n            }\n\n            $.ajax({\n                url: options.baseUrl + options.imagerySet,\n                data: {\n                    output: \"json\",\n                    include: \"ImageryProviders\",\n                    key: options.key,\n                    uriScheme: this._scheme()\n                },\n                type: \"get\",\n                dataType: \"jsonp\",\n                jsonp: \"jsonp\",\n                success: this._onMetadata\n            });\n        },\n\n        _scheme: function(proto) {\n            proto = proto || window.location.protocol;\n            return proto.replace(\":\", \"\") === \"https\" ? \"https\" : \"http\";\n        },\n\n        _onMetadata: function(data) {\n            if (data && data.resourceSets.length) {\n                var resource = this.resource = data.resourceSets[0].resources[0];\n\n                deepExtend(this._view.options, {\n                    urlTemplate: resource.imageUrl\n                        .replace(\"{subdomain}\", \"#= subdomain #\")\n                        .replace(\"{quadkey}\", \"#= quadkey #\")\n                        .replace(\"{culture}\", \"#= culture #\"),\n                    subdomains: resource.imageUrlSubdomains\n                });\n\n                var options = this.options;\n                if (!defined(options.minZoom)) {\n                    options.minZoom = resource.zoomMin;\n                }\n                if (!defined(options.maxZoom)) {\n                    options.maxZoom = resource.zoomMax;\n                }\n\n                this._addAttribution();\n\n                if (this.element.css(\"display\") !== \"none\") {\n                    this._reset();\n                }\n            }\n        },\n\n        _viewType: function() {\n            return BingView;\n        },\n\n        _addAttribution: function() {\n            var attr = this.map.attribution;\n            if (attr) {\n                var items = this.resource.imageryProviders;\n                if (items) {\n                    for (var i = 0; i < items.length; i++) {\n                        var item = items[i];\n                        for (var y = 0; y < item.coverageAreas.length; y++) {\n                            var area = item.coverageAreas[y];\n                            attr.add({\n                                text: item.attribution,\n                                minZoom: area.zoomMin,\n                                maxZoom: area.zoomMax,\n                                extent: new Extent(\n                                    new Location(area.bbox[2], area.bbox[1]),\n                                    new Location(area.bbox[0], area.bbox[3])\n                                )\n                            });\n                        }\n                    }\n                }\n            }\n        },\n\n        imagerySet: function(value) {\n            if (value) {\n                this.options.imagerySet = value;\n                this.map.attribution.clear();\n                this._fetchMetadata();\n            } else {\n                return this.options.imagerySet;\n            }\n        }\n    });\n\n    var BingView = TileView.extend({\n        options: {\n            culture: \"en-US\"\n        },\n\n        tileOptions: function(currentIndex) {\n            var options = TileView.fn.tileOptions.call(this, currentIndex);\n\n            options.culture = this.options.culture;\n            options.quadkey = this.tileQuadKey(this.wrapIndex(currentIndex));\n\n            return options;\n        },\n\n        tileQuadKey: function(index) {\n            var quadKey = \"\",\n                digit, mask, i;\n\n            for (i = this._zoom; i > 0; i--) {\n                digit = 0;\n                mask = 1 << (i - 1);\n\n                if ((index.x & mask) !== 0) {\n                    digit++;\n                }\n\n                if ((index.y & mask) !== 0) {\n                    digit += 2;\n                }\n\n                quadKey += digit;\n            }\n\n            return quadKey;\n        }\n    });\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                bing: BingLayer,\n                BingLayer: BingLayer,\n                BingView: BingView\n            }\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/layers/marker',[ \"./base\", \"../location\",\n             \"kendo.data\", \"kendo.tooltip\" ], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var doc = document,\n        math = Math,\n        indexOf = $.inArray,\n\n        kendo = window.kendo,\n        Class = kendo.Class,\n        DataSource = kendo.data.DataSource,\n        Tooltip = kendo.ui.Tooltip,\n\n        dataviz = kendo.dataviz,\n        deepExtend = kendo.deepExtend,\n\n        map = dataviz.map,\n        Location = map.Location,\n        Layer = map.layers.Layer;\n\n    // Implementation =========================================================\n    var MarkerLayer = Layer.extend({\n        init: function(map, options) {\n            Layer.fn.init.call(this, map, options);\n\n            this._markerClick = this._markerClick.bind(this);\n            this.element.on(\"click\", \".k-marker\", this._markerClick);\n\n            this.items = [];\n            this._initDataSource();\n        },\n\n        destroy: function() {\n            Layer.fn.destroy.call(this);\n\n            this.element.off(\"click\", \".k-marker\", this._markerClick);\n\n            this.dataSource.unbind(\"change\", this._dataChange);\n            this.clear();\n        },\n\n        options: {\n            zIndex: 1000,\n            autoBind: true,\n            dataSource: {},\n            locationField: \"location\",\n            titleField: \"title\"\n        },\n\n        add: function(arg) {\n            if (Array.isArray(arg)) {\n                for (var i = 0; i < arg.length; i++) {\n                    this._addOne(arg[i]);\n                }\n            } else {\n                return this._addOne(arg);\n            }\n        },\n\n        remove: function(marker) {\n            marker.destroy();\n\n            var index = indexOf(marker, this.items);\n            if (index > -1) {\n                this.items.splice(index, 1);\n            }\n        },\n\n        clear: function() {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n\n            this.items = [];\n        },\n\n        update: function(marker) {\n            var loc = marker.location();\n            if (loc) {\n                marker.showAt(this.map.locationToView(loc));\n\n                var args = { marker: marker, layer: this };\n                this.map.trigger(\"markerActivate\", args);\n            }\n        },\n\n        _reset: function() {\n            Layer.fn._reset.call(this);\n            var items = this.items;\n            for (var i = 0; i < items.length; i++) {\n                this.update(items[i]);\n            }\n        },\n\n        bind: function(options, dataItem) {\n            var marker = map.Marker.create(options, this.options);\n            marker.dataItem = dataItem;\n\n            var args = { marker: marker, layer: this };\n            var cancelled = this.map.trigger(\"markerCreated\", args);\n            if (!cancelled) {\n                this.add(marker);\n                return marker;\n            }\n        },\n\n        setDataSource: function(dataSource) {\n            if (this.dataSource) {\n                this.dataSource.unbind(\"change\", this._dataChange);\n            }\n\n            this.dataSource = kendo.data.DataSource.create(dataSource);\n            this.dataSource.bind(\"change\", this._dataChange);\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _addOne: function(arg) {\n            var marker = Marker.create(arg, this.options);\n            marker.addTo(this);\n\n            return marker;\n        },\n\n        _initDataSource: function() {\n            var dsOptions = this.options.dataSource;\n            this._dataChange = this._dataChange.bind(this);\n            this.dataSource = DataSource\n                .create(dsOptions)\n                .bind(\"change\", this._dataChange);\n\n            if (dsOptions && this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n        },\n\n        _dataChange: function(e) {\n            this._load(e.sender.view());\n        },\n\n        _load: function(data) {\n            this._data = data;\n            this.clear();\n\n            var getLocation = kendo.getter(this.options.locationField);\n            var getTitle = kendo.getter(this.options.titleField);\n            for (var i = 0; i < data.length; i++) {\n                var dataItem = data[i];\n                this.bind({\n                    location: getLocation(dataItem),\n                    title: getTitle(dataItem)\n                }, dataItem);\n            }\n        },\n\n        _markerClick: function(e) {\n            var args = { marker: $(e.target).data(\"kendoMarker\"), layer: this };\n            this.map.trigger(\"markerClick\", args);\n        }\n    });\n\n    var Marker = Class.extend({\n        init: function(options) {\n            this.options = options || {};\n        },\n\n        addTo: function(parent) {\n            this.layer = parent.markers || parent;\n            this.layer.items.push(this);\n            this.layer.update(this);\n        },\n\n        location: function(value) {\n            if (value) {\n                this.options.location = Location.create(value).toArray();\n\n                if (this.layer) {\n                    this.layer.update(this);\n                }\n\n                return this;\n            } else {\n                return Location.create(this.options.location);\n            }\n        },\n\n        showAt: function(point) {\n            this.render();\n            this.element.css({\n                left: math.round(point.x),\n                top: math.round(point.y)\n            });\n\n            if (this.tooltip && this.tooltip.popup) {\n                // TODO: Expose popup/tooltip updatePosition? method\n                this.tooltip.popup._position();\n            }\n        },\n\n        hide: function() {\n            if (this.element) {\n                this.element.remove();\n                this.element = null;\n            }\n\n            if (this.tooltip) {\n                this.tooltip.destroy();\n                this.tooltip = null;\n            }\n        },\n\n        destroy: function() {\n            this.layer = null;\n            this.hide();\n        },\n\n        render: function() {\n            if (!this.element) {\n                var options = this.options;\n                var layer = this.layer;\n\n                this.element = $(doc.createElement(\"span\"))\n                    .addClass(\"k-marker k-icon k-i-marker-\" + kendo.toHyphens(options.shape || \"pin\"))\n                    .attr(\"title\", options.title)\n                    .attr(options.attributes || {})\n                    .data(\"kendoMarker\", this)\n                    .css(\"zIndex\", options.zIndex);\n\n                if (layer) {\n                    layer.element.append(this.element);\n                }\n\n                this.renderTooltip();\n            }\n        },\n\n        renderTooltip: function() {\n            var marker = this;\n            var title = marker.options.title;\n            var options = marker.options.tooltip || {};\n\n            if (options && Tooltip) {\n                var template = options.template;\n                if (template) {\n                    var contentTemplate = kendo.template(template);\n                    options.content = function(e) {\n                        e.location = marker.location();\n                        e.marker = marker;\n                        return contentTemplate(e);\n                    };\n                }\n\n                if (title || options.content || options.contentUrl) {\n                    this.tooltip = new Tooltip(this.element, options);\n                    this.tooltip.marker = this;\n                }\n            }\n        }\n    });\n\n    Marker.create = function(arg, defaults) {\n        if (arg instanceof Marker) {\n            return arg;\n        }\n\n        return new Marker(deepExtend({}, defaults, arg));\n    };\n\n    // Exports ================================================================\n    deepExtend(dataviz, {\n        map: {\n            layers: {\n                marker: MarkerLayer,\n                MarkerLayer: MarkerLayer\n            },\n            Marker: Marker\n        }\n    });\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('dataviz/map/main',[\"./crs\", \"./location\"], f);\n})(function() {\n\n(function($, undefined) {\n    // Imports ================================================================\n    var doc = document,\n        math = Math,\n        min = math.min,\n        pow = math.pow,\n\n        kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        deepExtend = kendo.deepExtend,\n\n        dataviz = kendo.dataviz,\n        ui = dataviz.ui,\n\n        g = kendo.geometry,\n        Point = g.Point,\n\n        map = dataviz.map,\n        Extent = map.Extent,\n        Location = map.Location,\n        EPSG3857 = map.crs.EPSG3857,\n\n        util = kendo.util,\n        renderPos = util.renderPos,\n\n        drawingUtil = kendo.drawing.util,\n\n        defined = drawingUtil.defined,\n        limit = drawingUtil.limitValue,\n        valueOrDefault = drawingUtil.valueOrDefault;\n\n    // Constants ==============================================================\n    var CSS_PREFIX = \"k-\",\n        FRICTION = 0.90,\n        FRICTION_MOBILE = 0.93,\n        MOUSEWHEEL = \"DOMMouseScroll mousewheel\",\n        VELOCITY_MULTIPLIER = 5,\n        DEFAULT_ZOOM_RATE = 1;\n\n    // Map widget =============================================================\n    var Map = Widget.extend({\n        init: function(element, options) {\n            kendo.destroy(element);\n            Widget.fn.init.call(this, element);\n\n            this._initOptions(options);\n            this.bind(this.events, options);\n\n            this.crs = new EPSG3857();\n\n            this.element\n                .addClass(CSS_PREFIX + this.options.name.toLowerCase())\n                .css(\"position\", \"relative\")\n                .empty()\n                .append(doc.createElement(\"div\"));\n\n            this._viewOrigin = this._getOrigin();\n            this._initScroller();\n            this._initMarkers();\n            this._initControls();\n            this._initLayers();\n            this._reset();\n\n            this._mousewheel = this._mousewheel.bind(this);\n            this.element.on(MOUSEWHEEL, this._mousewheel);\n        },\n\n        options: {\n            name: \"Map\",\n            controls: {\n                attribution: true,\n                navigator: {\n                    panStep: 100\n                },\n                zoom: true\n            },\n            layers: [],\n            layerDefaults: {\n                shape: {\n                    style: {\n                        fill: {\n                            color: \"#fff\"\n                        },\n                        stroke: {\n                            color: \"#aaa\",\n                            width: 0.5\n                        }\n                    }\n                },\n                bubble: {\n                    style: {\n                        fill: {\n                            color: \"#fff\",\n                            opacity: 0.5\n                        },\n                        stroke: {\n                            color: \"#aaa\",\n                            width: 0.5\n                        }\n                    }\n                },\n                marker: {\n                    shape: \"pinTarget\",\n                    tooltip: {\n                        position: \"top\"\n                    }\n                }\n            },\n            center: [0, 0],\n            zoom: 3,\n            minSize: 256,\n            minZoom: 1,\n            maxZoom: 19,\n            markers: [],\n            markerDefaults: {\n                shape: \"pinTarget\",\n                tooltip: {\n                    position: \"top\"\n                }\n            },\n            wraparound: true,\n            messages: {\n                tileTitle: \"Map tile\"\n            }\n        },\n\n        events: [\n            \"beforeReset\",\n            \"click\",\n            \"markerActivate\",\n            \"markerClick\",\n            \"markerCreated\",\n            \"pan\",\n            \"panEnd\",\n            \"reset\",\n            \"shapeClick\",\n            \"shapeCreated\",\n            \"shapeFeatureCreated\",\n            \"shapeMouseEnter\",\n            \"shapeMouseLeave\",\n            \"zoomEnd\",\n            \"zoomStart\"\n        ],\n\n        destroy: function() {\n            this.scroller.destroy();\n\n            if (this.navigator) {\n                this.navigator.destroy();\n            }\n\n            if (this.attribution) {\n                this.attribution.destroy();\n            }\n\n            if (this.zoomControl) {\n                this.zoomControl.destroy();\n            }\n\n            this.markers.destroy();\n\n            for (var i = 0; i < this.layers.length; i++) {\n                this.layers[i].destroy();\n            }\n\n            Widget.fn.destroy.call(this);\n        },\n\n        zoom: function(level) {\n            var options = this.options;\n\n            if (defined(level)) {\n                level = math.round(limit(level, options.minZoom, options.maxZoom));\n                if (options.zoom !== level) {\n                    options.zoom = level;\n                    this._reset();\n                }\n\n                return this;\n            } else {\n                return options.zoom;\n            }\n        },\n\n        center: function(center) {\n            if (center) {\n                this.options.center = Location.create(center).toArray();\n                this._reset();\n\n                return this;\n            } else {\n                return Location.create(this.options.center);\n            }\n        },\n\n        extent: function(extent) {\n            if (extent) {\n                this._setExtent(extent);\n                return this;\n            } else {\n                return this._getExtent();\n            }\n        },\n\n        setOptions: function(options) {\n            Widget.fn.setOptions.call(this, options);\n            this._reset();\n        },\n\n        locationToLayer: function(location, zoom) {\n            var clamp = !this.options.wraparound;\n            location = Location.create(location);\n            return this.crs.toPoint(location, this._layerSize(zoom), clamp);\n        },\n\n        layerToLocation: function(point, zoom) {\n            var clamp = !this.options.wraparound;\n            point = Point.create(point);\n            return this.crs.toLocation(point, this._layerSize(zoom), clamp);\n        },\n\n        locationToView: function(location) {\n            location = Location.create(location);\n            var origin = this.locationToLayer(this._viewOrigin);\n            var point = this.locationToLayer(location);\n\n            return point.translateWith(origin.scale(-1));\n        },\n\n        viewToLocation: function(point, zoom) {\n            var origin = this.locationToLayer(this._getOrigin(), zoom);\n            point = Point.create(point);\n            point = point.clone().translateWith(origin);\n            return this.layerToLocation(point, zoom);\n        },\n\n        eventOffset: function(e) {\n            var point;\n            var x;\n            var y;\n            var offset = this.element.offset();\n\n            if (e.x || e.y) {\n                var field = \"location\";\n                x = e.x[field] - offset.left;\n                y = e.y[field] - offset.top;\n                point = new g.Point(x, y);\n            } else {\n                var event = e.originalEvent || e;\n                x = valueOrDefault(event.pageX, event.clientX) - offset.left;\n                y = valueOrDefault(event.pageY, event.clientY) - offset.top;\n                point = new g.Point(x, y);\n            }\n\n            return point;\n        },\n\n        eventToView: function(e) {\n            var cursor = this.eventOffset(e);\n            return this.locationToView(this.viewToLocation(cursor));\n        },\n\n        eventToLayer: function(e) {\n            return this.locationToLayer(this.eventToLocation(e));\n        },\n\n        eventToLocation: function(e) {\n            var cursor = this.eventOffset(e);\n            return this.viewToLocation(cursor);\n        },\n\n        viewSize: function() {\n            var element = this.element;\n            var scale = this._layerSize();\n            var width = element.width();\n\n            if (!this.options.wraparound) {\n                width = min(scale, width);\n            }\n            return {\n                width: width,\n                height: min(scale, element.height())\n            };\n        },\n\n        exportVisual: function() {\n            this._reset();\n            return false;\n        },\n\n        _setOrigin: function(origin, zoom) {\n            var size = this.viewSize(),\n                topLeft;\n\n            origin = this._origin = Location.create(origin);\n            topLeft = this.locationToLayer(origin, zoom);\n            topLeft.x += size.width / 2;\n            topLeft.y += size.height / 2;\n\n            this.options.center = this.layerToLocation(topLeft, zoom).toArray();\n\n            return this;\n        },\n\n        _getOrigin: function(invalidate) {\n            var size = this.viewSize(),\n                topLeft;\n\n            if (invalidate || !this._origin) {\n                topLeft = this.locationToLayer(this.center());\n                topLeft.x -= size.width / 2;\n                topLeft.y -= size.height / 2;\n\n                this._origin = this.layerToLocation(topLeft);\n            }\n\n            return this._origin;\n        },\n\n        _setExtent: function(extent) {\n            var raw = Extent.create(extent);\n            var se = raw.se.clone();\n            if (this.options.wraparound && se.lng < 0 && extent.nw.lng > 0) {\n                se.lng = 180 + (180 + se.lng);\n            }\n\n            extent = new Extent(raw.nw, se);\n            this.center(extent.center());\n\n            var width = this.element.width();\n            var height = this.element.height();\n            for (var zoom = this.options.maxZoom; zoom >= this.options.minZoom; zoom--) {\n                var topLeft = this.locationToLayer(extent.nw, zoom);\n                var bottomRight = this.locationToLayer(extent.se, zoom);\n\n                var layerWidth = math.abs(bottomRight.x - topLeft.x);\n                var layerHeight = math.abs(bottomRight.y - topLeft.y);\n\n                if (layerWidth <= width && layerHeight <= height) {\n                    break;\n                }\n            }\n\n            this.zoom(zoom);\n        },\n\n        _getExtent: function() {\n            var nw = this._getOrigin();\n            var bottomRight = this.locationToLayer(nw);\n            var size = this.viewSize();\n\n            bottomRight.x += size.width;\n            bottomRight.y += size.height;\n\n            var se = this.layerToLocation(bottomRight);\n            return new Extent(nw, se);\n        },\n\n        _zoomAround: function(pivot, level) {\n            this._setOrigin(this.layerToLocation(pivot, level), level);\n            this.zoom(level);\n        },\n\n        _initControls: function() {\n            var controls = this.options.controls;\n\n            if (ui.Attribution && controls.attribution) {\n                this._createAttribution(controls.attribution);\n            }\n\n            if (!kendo.support.mobileOS) {\n                if (ui.Navigator && controls.navigator) {\n                    this._createNavigator(controls.navigator);\n                }\n\n                if (ui.ZoomControl && controls.zoom) {\n                    this._createZoomControl(controls.zoom);\n                }\n            }\n        },\n\n        _createControlElement: function(options, defaultPos) {\n            var pos = options.position || defaultPos;\n            var posSelector = \".\" + renderPos(pos).replace(\" \", \".\");\n            var wrap = $(\".k-map-controls\" + posSelector, this.element);\n            if (wrap.length === 0) {\n                wrap = $(\"<div>\")\n                       .addClass(\"k-map-controls \" + renderPos(pos))\n                       .appendTo(this.element);\n            }\n\n            return $(\"<div>\").appendTo(wrap);\n        },\n\n        _createAttribution: function(options) {\n            var element = this._createControlElement(options, \"bottomRight\");\n            this.attribution = new ui.Attribution(element, options);\n        },\n\n        _createNavigator: function(options) {\n            var element = this._createControlElement(options, \"topLeft\");\n            var navigator = this.navigator = new ui.Navigator(element, options);\n\n            this._navigatorPan = this._navigatorPan.bind(this);\n            navigator.bind(\"pan\", this._navigatorPan);\n\n            this._navigatorCenter = this._navigatorCenter.bind(this);\n            navigator.bind(\"center\", this._navigatorCenter);\n        },\n\n        _navigatorPan: function(e) {\n            var map = this;\n            var scroller = map.scroller;\n\n            var x = scroller.scrollLeft + e.x;\n            var y = scroller.scrollTop - e.y;\n\n            var bounds = this._virtualSize;\n            var height = this.element.height();\n            var width = this.element.width();\n\n            // TODO: Move limits in scroller\n            x = limit(x, bounds.x.min, bounds.x.max - width);\n            y = limit(y, bounds.y.min, bounds.y.max - height);\n\n            map.scroller.one(\"scroll\", function(e) { map._scrollEnd(e); });\n            map.scroller.scrollTo(-x, -y);\n        },\n\n        _navigatorCenter: function() {\n            this.center(this.options.center);\n        },\n\n        _createZoomControl: function(options) {\n            var element = this._createControlElement(options, \"topLeft\");\n            var zoomControl = this.zoomControl = new ui.ZoomControl(element, options);\n\n            this._zoomControlChange = this._zoomControlChange.bind(this);\n            zoomControl.bind(\"change\", this._zoomControlChange);\n        },\n\n        _zoomControlChange: function(e) {\n            if (!this.trigger(\"zoomStart\", { originalEvent: e })) {\n                this.zoom(this.zoom() + e.delta);\n                this.trigger(\"zoomEnd\", { originalEvent: e });\n            }\n        },\n\n        _initScroller: function() {\n            var friction = kendo.support.mobileOS ? FRICTION_MOBILE : FRICTION;\n            var zoomable = this.options.zoomable !== false;\n            var scroller = this.scroller = new kendo.mobile.ui.Scroller(\n                this.element.children(0), {\n                    friction: friction,\n                    velocityMultiplier: VELOCITY_MULTIPLIER,\n                    zoom: zoomable,\n                    mousewheelScrolling: false,\n                    supportDoubleTap: true\n                });\n\n            scroller.bind(\"scroll\", this._scroll.bind(this));\n            scroller.bind(\"scrollEnd\", this._scrollEnd.bind(this));\n            scroller.userEvents.bind(\"gesturestart\", this._scaleStart.bind(this));\n            scroller.userEvents.bind(\"gestureend\", this._scale.bind(this));\n            scroller.userEvents.bind(\"doubleTap\", this._doubleTap.bind(this));\n            scroller.userEvents.bind(\"tap\", this._tap.bind(this));\n\n            this.scrollElement = scroller.scrollElement;\n        },\n\n        _initLayers: function() {\n            var defs = this.options.layers,\n                layers = this.layers = [];\n\n            for (var i = 0; i < defs.length; i++) {\n                var options = defs[i];\n                var type = options.type || \"shape\";\n                var defaults = this.options.layerDefaults[type];\n                var impl = dataviz.map.layers[type];\n\n                layers.push(new impl(this, deepExtend({}, defaults, options)));\n            }\n        },\n\n        _initMarkers: function() {\n            this.markers = new map.layers.MarkerLayer(this, this.options.markerDefaults);\n            this.markers.add(this.options.markers);\n        },\n\n        _scroll: function(e) {\n            var origin = this.locationToLayer(this._viewOrigin).round();\n            var movable = e.sender.movable;\n\n            var offset = new g.Point(movable.x, movable.y).scale(-1).scale(1 / movable.scale);\n            origin.x += offset.x;\n            origin.y += offset.y;\n\n            this._scrollOffset = offset;\n\n            this._setOrigin(this.layerToLocation(origin));\n            this.trigger(\"pan\", {\n                originalEvent: e,\n                origin: this._getOrigin(),\n                center: this.center()\n            });\n        },\n\n        _scrollEnd: function(e) {\n            if (!this._scrollOffset || !this._panComplete()) {\n                return;\n            }\n\n            this._scrollOffset = null;\n            this._panEndTS = new Date();\n\n            this.trigger(\"panEnd\", {\n                originalEvent: e,\n                origin: this._getOrigin(),\n                center: this.center()\n            });\n        },\n\n        _panComplete: function() {\n            return new Date() - (this._panEndTS || 0) > 50;\n        },\n\n        _scaleStart: function(e) {\n            if (this.trigger(\"zoomStart\", { originalEvent: e })) {\n                var touch = e.touches[1];\n                if (touch) {\n                    touch.cancel();\n                }\n            }\n        },\n\n        _scale: function(e) {\n            var scale = this.scroller.movable.scale;\n            var zoom = this._scaleToZoom(scale);\n            var gestureCenter = new g.Point(e.center.x, e.center.y);\n            var centerLocation = this.viewToLocation(gestureCenter, zoom);\n            var centerPoint = this.locationToLayer(centerLocation, zoom);\n            var originPoint = centerPoint.translate(-gestureCenter.x, -gestureCenter.y);\n\n            this._zoomAround(originPoint, zoom);\n            this.trigger(\"zoomEnd\", { originalEvent: e });\n        },\n\n        _scaleToZoom: function(scaleDelta) {\n            var scale = this._layerSize() * scaleDelta;\n            var tiles = scale / this.options.minSize;\n            var zoom = math.log(tiles) / math.log(2);\n\n            return math.round(zoom);\n        },\n\n        _reset: function() {\n            if (this.attribution) {\n                this.attribution.filter(this.center(), this.zoom());\n            }\n\n            this._viewOrigin = this._getOrigin(true);\n            this._resetScroller();\n            this.trigger(\"beforeReset\");\n            this.trigger(\"reset\", {\n                tileTitle: this.options.messages.tileTitle\n            });\n        },\n\n        _resetScroller: function() {\n            var scroller = this.scroller;\n            var x = scroller.dimensions.x;\n            var y = scroller.dimensions.y;\n            var scale = this._layerSize();\n            var nw = this.extent().nw;\n            var topLeft = this.locationToLayer(nw).round();\n\n            scroller.movable.round = true;\n            scroller.reset();\n            scroller.userEvents.cancel();\n\n            var zoom = this.zoom();\n            scroller.dimensions.forcedMinScale = pow(2, this.options.minZoom - zoom);\n            scroller.dimensions.maxScale = pow(2, this.options.maxZoom - zoom);\n\n            var xBounds = { min: -topLeft.x, max: scale - topLeft.x };\n            var yBounds = { min: -topLeft.y, max: scale - topLeft.y };\n\n            if (this.options.wraparound) {\n                xBounds.max = 20 * scale;\n                xBounds.min = -xBounds.max;\n            }\n\n            if (this.options.pannable === false) {\n                var viewSize = this.viewSize();\n                xBounds.min = yBounds.min = 0;\n                xBounds.max = viewSize.width;\n                yBounds.max = viewSize.height;\n            }\n\n            x.makeVirtual();\n            y.makeVirtual();\n            x.virtualSize(xBounds.min, xBounds.max);\n            y.virtualSize(yBounds.min, yBounds.max);\n\n            this._virtualSize = { x: xBounds, y: yBounds };\n        },\n\n        _renderLayers: function() {\n            var defs = this.options.layers,\n                layers = this.layers = [],\n                scrollWrap = this.scrollWrap;\n\n            scrollWrap.empty();\n\n            for (var i = 0; i < defs.length; i++) {\n                var options = defs[i];\n                var type = options.type || \"shape\";\n                var defaults = this.options.layerDefaults[type];\n                var impl = dataviz.map.layers[type];\n\n                layers.push(new impl(this, deepExtend({}, defaults, options)));\n            }\n        },\n\n        _layerSize: function(zoom) {\n            zoom = valueOrDefault(zoom, this.options.zoom);\n            return this.options.minSize * pow(2, zoom);\n        },\n\n        _tap: function(e) {\n            if (!this._panComplete()) {\n                return;\n            }\n\n            var cursor = this.eventOffset(e);\n            this.trigger(\"click\", {\n                originalEvent: e,\n                location: this.viewToLocation(cursor)\n            });\n        },\n\n        _doubleTap: function(e) {\n            var options = this.options;\n            if (options.zoomable !== false) {\n                if (!this.trigger(\"zoomStart\", { originalEvent: e })) {\n                    var toZoom = this.zoom() + DEFAULT_ZOOM_RATE;\n                    var cursor = this.eventOffset(e);\n                    var location = this.viewToLocation(cursor);\n                    var postZoom = this.locationToLayer(location, toZoom);\n                    var origin = postZoom.translate(-cursor.x, -cursor.y);\n                    this._zoomAround(origin, toZoom);\n                    this.trigger(\"zoomEnd\", { originalEvent: e });\n                }\n            }\n        },\n\n        _mousewheel: function(e) {\n            e.preventDefault();\n            var delta = dataviz.mwDelta(e) > 0 ? -1 : 1;\n            var options = this.options;\n            var fromZoom = this.zoom();\n            var toZoom = limit(fromZoom + delta, options.minZoom, options.maxZoom);\n\n            if (options.zoomable !== false && toZoom !== fromZoom) {\n                if (!this.trigger(\"zoomStart\", { originalEvent: e })) {\n                    var cursor = this.eventOffset(e);\n                    var location = this.viewToLocation(cursor);\n                    var postZoom = this.locationToLayer(location, toZoom);\n                    var origin = postZoom.translate(-cursor.x, -cursor.y);\n                    this._zoomAround(origin, toZoom);\n\n                    this.trigger(\"zoomEnd\", { originalEvent: e });\n                }\n            }\n        }\n    });\n\n    // Exports ================================================================\n    dataviz.ui.plugin(Map);\n\n})(window.kendo.jQuery);\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('kendo.dataviz.map',[\n        \"kendo.data\", \"kendo.userevents\", \"kendo.tooltip\", \"kendo.mobile.scroller\", \"kendo.draganddrop\",\n        \"kendo.dataviz.core\",\n\n        \"./dataviz/map/location\",\n        \"./dataviz/map/attribution\",\n        \"./dataviz/map/navigator\",\n        \"./dataviz/map/zoom\",\n        \"./dataviz/map/crs\",\n        \"./dataviz/map/layers/base\",\n        \"./dataviz/map/layers/shape\",\n        \"./dataviz/map/layers/bubble\",\n        \"./dataviz/map/layers/tile\",\n        \"./dataviz/map/layers/bing\",\n        \"./dataviz/map/layers/marker\",\n        \"./dataviz/map/main\"\n    ], f);\n})(function() {\n\n    var __meta__ = {\n        id: \"dataviz.map\",\n        name: \"Map\",\n        category: \"dataviz\",\n        description: \"The Kendo DataViz Map displays spatial data\",\n        depends: [ \"data\", \"userevents\", \"tooltip\", \"dataviz.core\", \"drawing\", \"mobile.scroller\" ]\n    };\n\n    return window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","kendo","window","deepExtend","sqr","value","now","Date","getTime","renderSize","size","renderPos","pos","result","parts","toHyphens","split","i","length","push","join","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","toLowerCase","digits","v","x","l","c","d","m","prev","charAt","memoize","f","cache","Object","create","id","arguments","apply","this","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","call","Return","ex","util","RegExp","amd","a1","a2","a3","$","jQuery","undefined","math","Math","abs","atan","atan2","cos","max","min","sin","tan","Class","dataviz","drawing","defined","deg","rad","round","valueOrDefault","Location","extend","init","lat","lng","DISTANCE_ITERATIONS","DISTANCE_CONVERGENCE","DISTANCE_PRECISION","FORMAT","toArray","equals","loc","clone","precision","wrap","distanceTo","dest","datum","greatCircleTo","distance","destination","bearing","map","datums","WGS84","fromLat","fromLng","dToR","a","asin","azimuthFrom","azimuthTo","b","L","U1","sinU1","cosU1","U2","sinU2","cosU2","lambda","prevLambda","converged","sinLambda","cosLambda","sino","cosA2","coso","cos2om","sigma","sqrt","sinA","C","u2","A","B","deltao","Extent","fn","toString","format","fromLngLat","ll","fromLatLng","nw","se","contains","center","containsAny","locs","include","includeAll","edges","ne","sw","overlaps","extent","World","Widget","ui","template","Attribution","element","options","_initOptions","items","addClass","name","separator","itemTemplate","filter","zoom","_extent","_zoom","_render","add","item","text","remove","clear","empty","_itemText","append","show","hide","inZoomLevel","_inZoomLevel","minZoom","maxZoom","inArea","_inArea","Number","MAX_VALUE","area","plugin","keys","NS","button","dir","BUTTONS","Navigator","on","_click","bind","parentElement","parent","closest","attr","_keyroot","_tabindex","_keydown","panStep","events","dispose","off","_pan","y","trigger","e","currentTarget","is","preventDefault","which","UP","DOWN","RIGHT","LEFT","iconClass","PLUS","MINUS","FF_PLUS","FF_MINUS","ZoomControl","zoomStep","_change","delta","NUMPAD_PLUS","NUMPAD_MINUS","exp","pow","log","g","geometry","Point","limit","limitValue","PI","PI_DIV_2","PI_DIV_4","DEG_TO_RAD","Mercator","MAX_LNG","MAX_LAT","INVERSE_ITERATIONS","INVERSE_CONVERGENCE","centralMeridian","forward","clamp","proj","lng0","_projectLat","ecc","ts","con","p","inverse","point","_inverseY","ecch","phi","dphi","SphericalMercator","Equirectangular","EPSG3857","crs","_proj","_tm","transform","translate","scale","_itm","toPoint","toLocation","EPSG3395","EPSG4326","projections","Layer","css","zIndex","opacity","appendTo","scrollElement","_beforeReset","_reset","_resize","_panEnd","_activate","_updateAttribution","destroy","_deactivate","reset","_applyExtent","_setVisibility","noop","matchMinZoom","matchMaxZoom","inside","visible","unbind","attribution","layers","DataSource","data","Group","last","ShapeLayer","surface","Surface","width","height","_initRoot","movable","Movable","_markers","_handler","_mouseenter","_mouseleave","_initDataSource","autoBind","dataSource","_dataChange","setDataSource","fetch","_translateSurface","_data","_load","_root","draw","dsOptions","sender","view","_clearMarkers","_loader","GeoJSONLoader","style","container","shape","parse","shapeCreated","cancelled","Circle","_createMarker","args","layer","featureCreated","marker","markers","location","dataItem","_panning","suspendTracking","resumeTracking","locationToView","moveTo","event","originalEvent","locator","defaultStyle","observer","root","unwrap","type","_loadGeometryTo","_featureCreated","children","_shapeCreated","group","properties","coords","coordinates","path","_loadPolygon","_setLineFill","_loadPoint","segments","anchor","fill","_loadShape","rings","_buildPolygon","MultiPath","Path","j","lineTo","circle","schemas","geojson","features","geometries","transports","read","dataType","getter","BubbleLayer","locationField","valueField","minSize","maxSize","symbol","opt","getValue","slice","sort","scaleType","_scaleType","_createSymbol","_drawSymbol","isFunction","scales","symbols","SqrtScale","domain","range","_domain","_range","domainRange","outputRange","_ratio","rel","Symbols","bubble","geo","square","halfSize","close","drawingUtil","TileLayer","subdomains","viewType","_viewType","_view","origin","locationToLayer","viewOrigin","tileTitle","_updateView","TileView","support","mobileOS","throttle","extentToPoint","render","pool","TilePool","tileSize","urlTemplate","_center","_viewOrigin","pointToTileIndex","floor","tileCount","firstTileIndex","indexToPoint","ceil","diff","index","subdomainText","subdomainIndex","_tileTitle","tile","createTile","currentIndex","tileOptions","get","wrapIndex","offset","roundPoint","subdomain","errorUrlTemplate","boundary","wrapValue","remainder","ImageTile","createElement","errorUrl","target","setAttribute","removeAttribute","top","left","url","visibility","urlResult","urlOptions","z","s","quadkey","q","culture","_items","_remove","_create","hashKey","maxDist","dist","splice","BingLayer","baseUrl","_scheme","_onMetadata","_fetchMetadata","imagerySet","key","Error","ajax","output","uriScheme","jsonp","success","proto","protocol","replace","resourceSets","resource","resources","imageUrl","imageUrlSubdomains","zoomMin","zoomMax","_addAttribution","BingView","imageryProviders","coverageAreas","bbox","tileQuadKey","quadKey","digit","mask","bing","doc","document","indexOf","inArray","Tooltip","MarkerLayer","_markerClick","titleField","arg","Array","isArray","_addOne","update","showAt","Marker","addTo","getLocation","getTitle","title","tooltip","popup","_position","attributes","renderTooltip","contentTemplate","content","contentUrl","defaults","CSS_PREFIX","FRICTION","FRICTION_MOBILE","MOUSEWHEEL","VELOCITY_MULTIPLIER","DEFAULT_ZOOM_RATE","Map","_getOrigin","_initScroller","_initMarkers","_initControls","_initLayers","_mousewheel","controls","navigator","layerDefaults","color","stroke","position","markerDefaults","wraparound","messages","scroller","zoomControl","level","_setExtent","_getExtent","setOptions","_layerSize","layerToLocation","translateWith","viewToLocation","eventOffset","field","pageX","clientX","pageY","clientY","eventToView","cursor","eventToLayer","eventToLocation","viewSize","exportVisual","_setOrigin","topLeft","_origin","invalidate","raw","bottomRight","layerWidth","layerHeight","_zoomAround","pivot","_createAttribution","_createNavigator","_createZoomControl","_createControlElement","defaultPos","posSelector","_navigatorPan","_navigatorCenter","scrollLeft","scrollTop","bounds","_virtualSize","one","_scrollEnd","scrollTo","_zoomControlChange","friction","zoomable","mobile","Scroller","velocityMultiplier","mousewheelScrolling","supportDoubleTap","_scroll","userEvents","_scaleStart","_scale","_doubleTap","_tap","defs","impl","_scrollOffset","_panComplete","_panEndTS","touch","touches","cancel","_scaleToZoom","gestureCenter","centerLocation","centerPoint","originPoint","scaleDelta","tiles","_resetScroller","dimensions","forcedMinScale","maxScale","xBounds","yBounds","pannable","makeVirtual","virtualSize","_renderLayers","scrollWrap","toZoom","postZoom","mwDelta","fromZoom","__meta__","category","description","depends"],"mappings":"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"}