/**
 * Kendo UI v2022.3.913 (http://www.telerik.com/kendo-ui)
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(define){define("excel/kendo-excel.min",["kendo.core.min"],function(){var f=window.kendo.jQuery,o=(window.kendo.excel=window.kendo.excel||{},kendo.getter),t=f.map,r={compile:function(e){return e}},n=kendo.Class.extend({});function a(e){return e.title+": "+e.value}function i(e,t){var r=[];for(var o=0;o<e;o++)r.push(t(o));return r}function p(e){return e.id}n.register=function(e){r=e},n.compile=function(e){return r.compile(e)};var e=kendo.Class.extend({init:function(e){e.columns=this._trimColumns(e.columns||[]);this.allColumns=t(this._leafColumns(e.columns||[]),this._prepareColumn);this.columns=this._visibleColumns(this.allColumns);this.options=e;this.data=e.data||[];this.aggregates=e.aggregates||{};this.groups=[].concat(e.groups||[]);this.hasGroups=this.groups.length>0;this.hierarchy=e.hierarchy;this.hasGroupHeaderColumn=this.columns.some(function(e){return e.groupHeaderColumnTemplate});this.collapsible=this.options.collapsible},workbook:function(){var e={sheets:[{columns:this._columns(),rows:this.hierarchy?this._hierarchyRows():this._rows(),freezePane:this._freezePane(),filter:this._filter()}]};return e},_trimColumns:function(e){var r=this;return e.filter(function(e){var t=Boolean(e.field);if(!t&&e.columns)t=r._trimColumns(e.columns).length>0;return t})},_leafColumns:function(e){var t=this;var r=[];for(var o=0;o<e.length;o++)if(!e[o].columns)r.push(e[o]);else r=r.concat(t._leafColumns(e[o].columns));return r},_prepareColumn:function(t){if(!t.field)return null;var e=function(e){return o(t.field,true)(e)};var r=null;if(t.values){r={};t.values.forEach(function(e){r[e.value]=e.text});e=function(e){return r[o(t.field,true)(e)]}}return f.extend({},t,{value:e,values:r,groupHeaderTemplate:t.groupHeaderTemplate?n.compile(t.groupHeaderTemplate):a,groupHeaderColumnTemplate:t.groupHeaderColumnTemplate?n.compile(t.groupHeaderColumnTemplate):null,groupFooterTemplate:t.groupFooterTemplate?n.compile(t.groupFooterTemplate):null,footerTemplate:t.footerTemplate?n.compile(t.footerTemplate):null})},_filter:function(){if(!this.options.filterable)return null;var e=this._depth();return{from:e,to:e+this.columns.length-1}},_createPaddingCells:function(e){var t=this;return i(e,function(){return f.extend({background:"#dfdfdf",color:"#333"},t.options.paddingCellOptions)})},_dataRow:function(e,t,r){var o=this;var n=this._createPaddingCells(t);if(this.hasGroups&&r&&e.items){n=n.concat(this._groupHeaderCells(e,t,r));var a=this._dataRows(e.items,t+1);a.unshift({type:"group-header",cells:n,level:this.collapsible?t:null});return a.concat(this._footer(e,t))}var i=[];for(var l=0;l<this.columns.length;l++)i[l]=o._cell(e,o.columns[l]);if(this.hierarchy)i[0].colSpan=r-t+1;return[{type:"data",cells:n.concat(i),level:this.collapsible?t:null}]},_groupHeaderCells:function(r,e,t){var o=[];var n=this.allColumns.filter(function(e){return e.field===r.field})[0]||{};var a=n&&n.title?n.title:r.field;var i=n?n.groupHeaderTemplate||n.groupHeaderColumnTemplate:null;var l=f.extend({title:a,field:r.field,value:n&&n.values?n.values[r.value]:r.value,aggregates:r.aggregates,items:r.items},r.aggregates[r.field]);var s=i?i(l):a+": "+r.value;o.push(f.extend({value:s,background:"#dfdfdf",color:"#333",colSpan:(this.hasGroupHeaderColumn?1:this.columns.length)+t-e},n.groupHeaderCellOptions));if(this.hasGroupHeaderColumn)this.columns.forEach(function(e,t){if(t>0)o.push(f.extend({background:"#dfdfdf",color:"#333",value:e.groupHeaderColumnTemplate?e.groupHeaderColumnTemplate(f.extend({group:l},l,r.aggregates[e.field])):undefined},e.groupHeaderCellOptions))});return o},_dataRows:function(e,t){var r=this;var o=this._depth();var n=[];for(var a=0;a<e.length;a++)n.push.apply(n,r._dataRow(e[a],t,o));return n},_hierarchyRows:function(){var e=this;var t=this._depth();var r=this.data;var c=this.hierarchy.itemLevel;var f=this.hierarchy.itemId||p;var o=this._hasFooterTemplate();var n=[];var a=[];var i=0;var h;if(!o)this.collapsible=false;for(var l=0;l<r.length;l++){var s=r[l];var u=c(s,l);if(o){if(u>i)a.push({id:h,level:i});else if(u<i)n.push.apply(n,e._hierarchyFooterRows(a,u,t));i=u;h=f(s,l)}n.push.apply(n,e._dataRow(s,u+1,t))}if(o){n.push.apply(n,this._hierarchyFooterRows(a,0,t));var d=r.length?this.aggregates[r[0].parentId]:{};n.push(this._hierarchyFooter(d,0,t))}this._prependHeaderRows(n);return n},_hierarchyFooterRows:function(e,t,r){var o=this;var n=[];while(e.length&&e[e.length-1].level>=t){var a=e.pop();n.push(o._hierarchyFooter(o.aggregates[a.id],a.level+1,r))}return n},_hasFooterTemplate:function(){var e=this.columns;for(var t=0;t<e.length;t++)if(e[t].footerTemplate)return true},_hierarchyFooter:function(n,a,i){var e=this.columns.map(function(e,t){var r=t?1:i-a+1;if(e.footerTemplate){var o=(n||{})[e.field];return f.extend({background:"#dfdfdf",color:"#333",colSpan:r,value:e.footerTemplate(f.extend({aggregates:n},o))},e.footerCellOptions)}return f.extend({background:"#dfdfdf",color:"#333",colSpan:r},e.footerCellOptions)});return{type:"footer",cells:this._createPaddingCells(a).concat(e),level:this.collapsible?a:null}},_footer:function(r,e){var t=[];var o=this.columns.some(function(e){return e.groupFooterTemplate});var n,a;if(o){a={group:{items:r.items,field:r.field,value:r.value}};n={};Object.keys(r.aggregates).forEach(function(e){n[e]=f.extend({},r.aggregates[e],a)})}var i=this.columns.map(function(e){if(e.groupFooterTemplate){var t=f.extend({},n,r.aggregates[e.field],a);return f.extend({background:"#dfdfdf",color:"#333",value:e.groupFooterTemplate(t)},e.groupFooterCellOptions)}return f.extend({background:"#dfdfdf",color:"#333"},e.groupFooterCellOptions)});if(o)t.push({type:"group-footer",cells:this._createPaddingCells(this.groups.length).concat(i),level:this.collapsible?e:null});return t},_isColumnVisible:function(e){return this._visibleColumns([e]).length>0&&(e.field||e.columns)},_visibleColumns:function(e){var a=this;return e.filter(function(e){var t=e.exportable;if(typeof t==="object")t=e.exportable.excel;var r=!e.hidden&&t!==false;var o=e.hidden&&t===true;var n=r||o;if(n&&e.columns)n=a._visibleColumns(e.columns).length>0;return n})},_headerRow:function(t,e){var r=this;var o=t.cells.map(function(e){return f.extend(e,{colSpan:e.colSpan>1?e.colSpan:1,rowSpan:t.rowSpan>1&&!e.colSpan?t.rowSpan:1})});if(this.hierarchy&&o[0].firstCell)o[0].colSpan+=this._depth();return{type:"header",cells:i(e.length,function(){return f.extend({background:"#7a7a7a",color:"#fff"},r.options.headerPaddingCellOptions)}).concat(o)}},_prependHeaderRows:function(e){var t=this;var r=this.groups;var o=[{rowSpan:1,cells:[],index:0}];this._prepareHeaderRows(o,this.options.columns);for(var n=o.length-1;n>=0;n--)e.unshift(t._headerRow(o[n],r))},_prepareHeaderRows:function(e,t,r,c){var o=this;var n=c||e[e.length-1];var a=e[n.index+1];var i=0;for(var l=0;l<t.length;l++){var s=t[l];if(o._isColumnVisible(s)){var u=f.extend({background:"#7a7a7a",color:"#fff",value:s.title||s.field,colSpan:0,firstCell:l===0&&(!r||r.firstCell)},s.headerCellOptions);n.cells.push(u);if(s.columns&&s.columns.length){if(!a){a={rowSpan:0,cells:[],index:e.length};e.push(a)}u.colSpan=o._trimColumns(o._visibleColumns(s.columns)).length;o._prepareHeaderRows(e,s.columns,u,a);i+=u.colSpan-1;n.rowSpan=e.length-n.index}}}if(r)r.colSpan+=i},_rows:function(){var t=this;var e=this._dataRows(this.data,0);if(this.columns.length){this._prependHeaderRows(e);var r=false;var o=this.columns.map(function(e){if(e.footerTemplate){r=true;return f.extend({background:"#dfdfdf",color:"#333",value:e.footerTemplate(f.extend({},t.aggregates,t.aggregates[e.field]))},e.footerCellOptions)}return f.extend({background:"#dfdfdf",color:"#333"},e.footerCellOptions)});if(r)e.push({type:"footer",cells:this._createPaddingCells(this.groups.length).concat(o)})}return e},_headerDepth:function(e){var t=this;var r=1;var o=0;for(var n=0;n<e.length;n++)if(e[n].columns){var a=t._headerDepth(e[n].columns);if(a>o)o=a}return r+o},_freezePane:function(){var e=this._visibleColumns(this.options.columns||[]);var t=this._visibleColumns(this._trimColumns(this._leafColumns(e.filter(function(e){return e.locked})))).length;return{rowSplit:this._headerDepth(e),colSplit:t?t+this.groups.length:0}},_cell:function(e,t){return f.extend({value:t.value(e)},t.cellOptions)},_depth:function(){var e=0;if(this.hierarchy)e=this.hierarchy.depth;else e=this.groups.length;return e},_columns:function(){var e=this._depth();var t=i(e,function(){return{width:20}});return t.concat(this.columns.map(function(e){return{width:parseInt(e.width,10),autoWidth:e.width?false:true}}))}});kendo.deepExtend(kendo.excel,{ExcelExporter:e,TemplateService:n})})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("excel/main.min",["kendo.core.min","kendo.data.min","./kendo-excel.min"],function(){var e=kendo.jQuery,a=kendo,r=a.excel.ExcelExporter,i=e.extend;return a.excel.TemplateService.register({compile:a.template}),a.ExcelExporter=a.Class.extend({init:function(e){this.options=e;var t=e.dataSource;if(t instanceof a.data.DataSource){if(!t.filter())t.options.filter=undefined;this.dataSource=new t.constructor(i({},t.options,{page:e.allPages?0:t.page(),filter:t.filter(),pageSize:e.allPages?t.total():t.pageSize()||t.total(),sort:t.sort(),group:t.group(),aggregate:t.aggregate()}));var r=t.data();if(r.length>0){if(e.hierarchy)for(var o=0;o<r.length;o++)if(r[o].expanded===false||r[o].expanded===undefined)r[o].expanded=true;this.dataSource._data=r;var n=this.dataSource.transport;if(t._isServerGrouped()&&n.options&&n.options.data)n.options.data=null}}else this.dataSource=a.data.DataSource.create(t)},_hierarchy:function(){var e=this.options.hierarchy;var t=this.dataSource;if(e&&t.level){e={itemLevel:function(e){return t.level(e)}};var r=t.view();var o=0;var n;for(var a=0;a<r.length;a++){n=t.level(r[a]);if(n>o)o=n}e.depth=o+1}else e=false;return{hierarchy:e}},workbook:function(){return e.Deferred(function(t){this.dataSource.fetch().then(function(){var e=new r(i({},this.options,this._hierarchy(),{data:this.dataSource.view(),groups:this.dataSource.group(),aggregates:this.dataSource.aggregates()})).workbook();t.resolve(e,this.dataSource.view())}.bind(this))}.bind(this)).promise()}}),kendo})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("excel/mixins.min",["./main.min","kendo.ooxml.min"],function(){var t=kendo.jQuery,n=kendo;return n.ExcelMixin={extend:function(e){e.events.push("excelExport");e.options.excel=t.extend(e.options.excel,this.options);e.saveAsExcel=this.saveAsExcel},options:{proxyURL:"",allPages:false,filterable:false,fileName:"Export.xlsx",collapsible:false},saveAsExcel:function(){var o=this.options.excel||{};var e=new n.ExcelExporter({columns:this.columns,dataSource:this.dataSource,allPages:o.allPages,filterable:o.filterable,hierarchy:o.hierarchy,collapsible:o.collapsible});e.workbook().then(function(t,e){if(!this.trigger("excelExport",{workbook:t,data:e})){var r=new n.ooxml.Workbook(t);if(!r.options)r.options={};r.options.skipCustomHeight=true;r.toDataURLAsync().then(function(e){n.saveAs({dataURI:e,fileName:t.fileName||o.fileName,proxyURL:o.proxyURL,forceProxy:o.forceProxy})})}}.bind(this))}},kendo})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()}),function(define){define("kendo.excel.min",["./excel/main.min","./excel/mixins.min"],function(){var e={id:"excel",name:"Excel export",category:"framework",advanced:true,mixin:true,depends:["data","ooxml"]}})}("function"==typeof define&&define.amd?define:function(e,t,r){(r||t)()});
//# sourceMappingURL=kendo.excel.min.js.map
