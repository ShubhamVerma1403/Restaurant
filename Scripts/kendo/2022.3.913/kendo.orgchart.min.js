/**
 * Kendo UI v2022.3.913 (http://www.telerik.com/kendo-ui)
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(define){define("orgchart/data.min",["kendo.data.min","kendo.treelist.min"],function(){var n=window.kendo.jQuery,o=void 0,d=n.extend,e=kendo.data,c=e.Query,t=e.DataSource,i=e.TreeListDataSource,l=e.Model,r=e.ObservableArray,u=l.define({id:"id",parentId:"parentId",fields:{id:{type:"number",editable:false},parentId:{type:"number",nullable:true},name:{type:"string",validation:{required:true}},title:{type:"string"},avatar:{type:"string"}},init:function(e){l.fn.init.call(this,e);this._loaded=false;if(!this.parentIdField)this.parentIdField="parentId";if(!this.nameField)this.nameField="name";if(!this.titleField)this.titleField="title";if(!this.avatarField)this.avatarField="avatar";this.parentId=this.get(this.parentIdField);this.name=this.get(this.nameField);this.title=this.get(this.titleField);this.avatar=this.get(this.avatarField)},accept:function(e){l.fn.accept.call(this,e);this.parentId=this.get(this.parentIdField);this.name=this.get(this.nameField);this.title=this.get(this.titleField);this.avatar=this.get(this.avatarField)},set:function(e,t,i){if(e=="parentId"&&this.nameField!="parentId")this[this.parentIdField]=t;if(e=="name"&&this.nameField!="name")this[this.nameField]=t;if(e=="title"&&this.titleField!="title")this[this.titleField]=t;if(e=="avatar"&&this.avatarField!="avatar")this[this.avatarField]=t;l.fn.set.call(this,e,t,i);if(e==this.parentIdField)this.parentId=this.get(this.parentIdField);if(e==this.nameField)this.name=this.get(this.nameField);if(e==this.titleField)this.title=this.get(this.titleField);if(e==this.avatarField)this.avatar=this.get(this.avatarField)},loaded:function(e){if(e!==o)this._loaded=e;else return this._loaded},shouldSerialize:function(e){return l.fn.shouldSerialize.call(this,e)&&e!=="_loaded"&&e!="_error"&&e!="_edit"&&!(this.parentIdField!=="parentId"&&e==="parentId")}}),a=(u.parentIdField="parentId",u.nameField="name",u.titleField="title",u.avatarField="avatar",u.define=function(e,t){if(t===o){t=e;e=u}var i=t.parentId||"parentId";var a=t.name||"name";var n=t.title||"title";var r=t.avatar||"avatar";t.parentIdField=i;t.nameField=a;t.titleField=n;t.avatarField=r;var s=l.define(e,t);if(i)s.parentIdField=i;if(a)s.nameField=a;if(n)s.titleField=n;if(r)s.avatarField=r;return s},i.extend({init:function(e){i.fn.init.call(this,d(true,{},{schema:{modelBase:u,model:u}},e))},groupedItemsTree:function(e){var t=this._childrenMap(this.view()),i=this._defaultParentId(),a=t[i]||[],n=new c(a).group({field:e}).toArray();return this._innerGroupedItemsTree(e,n,t)},itemChildren:function(e,t){var i={field:"parentId",operator:"eq",value:null};var a=this._sort&&this._sort.length?this._sort:{};var n,r;if(t)r=this.view();else r=this.data();if(!!e){n=e.get("id");if(n===o||n===null||n==="")return[];i.value=n}r=new c(r).filter(i).sort(a).toArray();return r},itemsTree:function(e,t){var i=[],a,n=this.itemChildren(e,true),r,s;for(s=0;s<n.length;s++){a=n[s];if(a.get("expanded")){r=this.itemsTree(a,t);a=d(true,{},a);a.children=r}a=d(true,{},a);i.push(a)}if(t!==null&&t!==o)i=new c(i).group({field:t}).toArray();return i},prospectParents:function(e,t){var i=[],a,n=this.itemChildren(t,false),r,s;for(s=0;s<n.length;s++){a=n[s];if(a.get("id")===e.get("id"))continue;i.push(a);if(a.get("hasChildren")){r=this.prospectParents(e,a);i=i.concat(r)}}return i},read:function(e){return t.fn.read.call(this,e).then(this._loadExpanded.bind(this,e))},toggleChildren:function(e,t){var i=n.Deferred().resolve().promise(),a=e.loaded();if(e._error){e.expanded=false;e._error=o}if(typeof t=="undefined")t=!e.expanded;e.expanded=t;if(!a)i=this.load(e);return i},_innerGroupedItemsTree:function(e,t,i){var a,n,r,s,o,d,l,u;for(n=0;n<t.length;n++){a=t[n];d=[];u=false;for(r=0;r<a.items.length;r++){l=a.items[r];if(!a.hasChildren&&l.hasChildren)a.hasChildren=true;if(l.expanded)a.expanded=true;s=a.items[r].get("id");d=d.concat(i[s])}if(a.expanded){o=new c(d).group({field:e}).toArray();a.children=this._innerGroupedItemsTree(e,o,i)}if(!a.hasChildren&&d.length>0)a.hasChildren=true}return t},_loadExpanded:function(e){var t,i,a;if(!e)return;if(e.id!==null&&e.id!==o)t=this._byParentId(e.id);else t=this._byParentId(this._defaultParentId());for(i=0;i<t.length;i++){a=t[i];if(a.expanded&&!a.loaded())this.toggleChildren(a,true)}}}));return a.create=function(e){if(Array.isArray(e))e={data:e};else if(e instanceof r)e={data:e.toJSON()};if(!(e instanceof a)&&e instanceof t)throw new Error("Incorrect DataSource type. Only OrgChartDataSource instances are supported");return e instanceof a?e:new a(e)},d(true,kendo.data,{OrgChartModel:u,OrgChartDataSource:a}),window.kendo})}("function"==typeof define&&define.amd?define:function(e,t,i){(i||t)()}),function(define){define("orgchart/view.min",["kendo.core.min"],function(){var I=window.kendo.jQuery,e=void 0,C=window.kendo,l=C.keys,p=I.extend,t=".kendoOrgChartView",i="blur",a="click",d="collapse",u="expand",n="focus",r="keydown",c="menu",o="select",y=".",w=" ",h=",",f="#",g="string",m="tabindex",v="id",s="uid",x="px",F="plus",T="minus",_="aria-owns",k="aria-selected",S={wrapper:"k-orgchart",container:"k-orgchart-container",line:"k-orgchart-line",lineVertical:"k-orgchart-line-v",lineHorizontal:"k-orgchart-line-h",lineVerticalTop:"k-orgchart-line-v-top",group:"k-orgchart-group",groupVertical:"k-orgchart-group-v",groupHorizontal:"k-orgchart-group-h",nodesGroup:"k-orgchart-node-group",nodesGroupContainer:"k-orgchart-node-group-container",nodeContainer:"k-orgchart-node-container",node:"k-orgchart-node",card:"k-orgchart-card",cardMenu:"k-orgchart-card-menu",button:"k-orgchart-button",focused:"k-focus",plusIcon:"k-i-plus",menuItem:"k-item",avatarPreview:"k-orgchart-avatar-preview",update:"k-orgchart-update",cancel:"k-orgchart-cancel",vstack:"k-vstack",hstack:"k-hstack"},b='<div role="tree" aria-orientation="horizontal" aria-label="#: label #" class="k-orgchart-group k-orgchart-level-1 k-pos-absolute k-hstack k-justify-content-center"></div>',E='<div role="group" id="#: guid #" class="k-orgchart-level-#: level # k-orgchart-group k-pos-absolute k-justify-content-around"></div>',G='<div role="treeitem" '+"# if(data.hasChildren && data.guid) { #"+'aria-owns="#: guid #" '+"# if(!!data.expanded) { #"+'aria-expanded="true" '+"# } else { #"+'aria-expanded="false" '+"# } #"+"# } #"+'aria-keyshortcuts="Enter" aria-level="#: level #" aria-selected="false" class="k-orgchart-node-group-container">',H='<div class="k-orgchart-node-container k-justify-content-around" style="width:100%"></div>',D='<div role="group" class="k-orgchart-node-container k-justify-content-around k-hstack" style="width:100%"></div>',P='<div class="k-orgchart-node k-vstack k-align-items-center"></div>',O='<button aria-label="#: label #" tabindex="-1" class="k-orgchart-button k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button">'+'<span class="k-button-icon k-icon k-i-#: buttonSign #"></span>'+"</button>",L='<div class="k-card-body k-hstack" style="border-color:#: color #">'+"# if(!!data.avatar) { #"+'<div class="k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full">'+'<span class="k-avatar-image">'+'<img alt="#: name #" src="#: avatar #">'+"</span>"+"</div>"+"# } #"+'<div class="k-vstack k-card-title-wrap">'+'<div class="k-card-title k-text-ellipsis">#: name #</div>'+"# if(data.title) { #"+'<span class="k-spacer"></span>'+'<div class="k-card-subtitle k-text-ellipsis">#: title #</div>'+"# } #"+"</div>"+"# if(editable) { #"+'<span class="k-spacer"></span>'+'<div class="k-card-body-actions">'+'<button class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button k-orgchart-card-menu" role="button" aria-label="#: menuLabel #" tabindex="-1">'+'<span class="k-button-icon k-icon k-i-more-vertical"></span>'+"</button>"+"</div>"+"# } #"+"</div>",V='<div role="treeitem" data-uid="#: uid #" '+"# if(data.hasChildren && data.guid) { #"+'aria-owns="#: guid #" '+"# if(!!data.expanded) { #"+'aria-expanded="true" '+"# } else { #"+'aria-expanded="false" '+"# } #"+"# } #"+'class="k-orgchart-card k-card '+"# if(!!data.cssClass) { #"+"#: data.cssClass #"+"# } #"+'" aria-keyshortcuts="Enter" aria-level="#: level #" aria-selected="false">'+"</div>",W='<div role="treeitem" data-uid="#: uid #" aria-level="#: level #" aria-selected="false" aria-keyshortcuts="Enter" '+'class="k-orgchart-card k-card '+"# if(!!data.cssClass) { #"+"#: data.cssClass #"+"# } #"+'"></div>',M=C.Observable.extend({init:function(e,t){this.element=e;this.options=t||{};C.Observable.fn.init.call(this);this._attachEvents()},events:[d,u,o,c],destroy:function(){C.ui.Widget.fn.destroy.call(this);this.element.off(t)},collapse:function(){return false},expand:function(){return false},jqueryGroupElement:function(e){if(!e)return;var t=this._processItem(e);if(!t.hasClass(S.nodesGroupContainer))t=t.closest(y+S.nodesGroupContainer);return t&&t.length?t:null},jqueryItemElement:function(e){if(!e)return;var t=this._processItem(e);if(!t.hasClass(S.card))t=t.closest(y+S.card);return t&&t.length?t:null},refresh:function(){this._cacheFocused();this._clearContent();this._generateItemsTree();this._calculateLevels();this._render()},select:function(e){var t=this._getToSelect(e),i=this.element.find("[tabindex=0]");if(!t)return;i.removeAttr(m).removeClass(S.focused).attr(k,false);t.attr(m,"0").addClass(S.focused).trigger("focus").attr(k,true)},_attachEvents:function(){var e=y+S.card+h+y+S.nodesGroupContainer;this.element.on(r+t,e,this._onKeyDown.bind(this)).on(a+t,e,this._onSelect.bind(this)).on(a+t,y+S.button,this._onButtonClick.bind(this)).on(n+t,e,this._onFocus.bind(this)).on(i+t,y+S.focused,this._onBlur.bind(this))},_cacheFocused:function(){var e=this.element.find("[tabindex='0']"),t=this._dataItems(e);if(!e.length||!t||!t.length||!!this._idTabIndex)return;this._idTabIndex=t[0].get(v);if(e.hasClass(S.focused))this._shouldRestoreSelection=true;else this._shouldRestoreSelection=false},_calculateDimensions:function(){var e=this.element.find(y+this._selector).first();if(!this._buttonHeight)this._buttonHeight=this.element.find(y+S.button).first().outerHeight();if(!this._spacing)this._spacing=this.element.find(y+S.lineVertical).first().outerHeight();if(!this._itemWidth)this._itemWidth=this._calculateItemWidth();if(!this._itemHeight)this._itemHeight=e.outerHeight(true)},_calculateItemWidth:function(){return false},_calculateLevel:function(){return false},_calculateLevels:function(){return false},_clearContent:function(){this.element.empty()},_dataItem:function(e){var t=this.jqueryItemElement(e);if(!t||!t.data(s))return;return this.dataSource.getByUid(t.data(s))},_dataItems:function(){return false},_generateItemsTree:function(){return false},_getToSelect:function(){return false},_groupIsVertical:function(){return false},_keyCollapse:function(){return false},_keyExpand:function(){return false},_keyNext:function(){return false},_keyPrev:function(){return false},_keyEnter:function(){return false},_keyEscape:function(){return false},_keyEnd:function(){var e=this.element.find(y+S.card).last(),t=this.element.find("[tabindex=0]");if(t[0]===e[0])return;this.trigger(o,{item:e,dataItems:[this._dataItem(e)]})},_keyHome:function(){var e=this.element.find(y+S.card).first(),t=this.element.find("[tabindex=0]");if(t[0]===e[0])return;this.trigger(o,{item:e,dataItems:[this._dataItem(e)]})},_onBlur:function(){this.element.find(y+S.focused).removeClass(S.focused)},_onKeyDown:function(e){var t=e.keyCode,i=this.element.find("[tabindex=0]"),a=C.support.isRtl(this.element),n=a?[l.LEFT]:[l.RIGHT],r=a?[l.RIGHT]:[l.LEFT],s=l.DOWN,o=l.UP,d;if(!i)return;d=this._groupIsVertical(i);if(d){n.push(l.DOWN);r.push(l.UP)}if(t===l.HOME)this._keyHome();else if(t===l.END)this._keyEnd();else if(n.indexOf(t)>-1){e.preventDefault();e.stopPropagation();this._keyNext(i)}else if(r.indexOf(t)>-1){e.preventDefault();e.stopPropagation();this._keyPrev(i)}else if(t===s){e.preventDefault();e.stopPropagation();this._keyExpand(i)}else if(t===o){e.preventDefault();e.stopPropagation();this._keyCollapse(i)}else if(t===l.ENTER)this._keyEnter(i);else if(t===l.ESC)this._keyEscape(i)},_onButtonClick:function(e){var t=this,i=I(e.currentTarget),a=i.find(y+S.plusIcon).length>0?true:false,n=i.siblings(y+this._selector),r=this._dataItems(n),s;if(a){if(t.trigger(u,{item:n,dataItems:r}))return}else if(t.trigger(d,{item:n,dataItems:r}))return;for(s=0;s<r.length;s++)t.dataSource.toggleChildren(r[s],a).then(this.refresh.bind(this))},_onFocus:function(){return false},_onSelect:function(){return false},_orientation:function(){return false},_processItem:function(e){var t;if(I.type(e)===g)t=this.element.find(e);else if(C.isElement(e))t=I(e);else if(e instanceof jQuery)t=e;return t},_render:function(){var e=this._itemsTree,t=I(C.template(b)({label:this.options.messages.label})),i=this.element,a=this._total,n=i.closest(y+S.wrapper).css("padding-left"),r;i.append(t);this._renderGroup(t,e,1,this._total,0);r=a*this._itemWidth+(a-1)*this._spacing;t.width(r);i.width(r+Number(n.split(x)[0]));this._setHeight();this._restoreSelection()},_renderNode:function(e,t,i,a,n){var r=this.options.messages,s=this.options.cardsColors||C.getSeriesColors(),o=I(P),d,l;l=I(e(p(true,{},i,{menuLabel:r.menuLabel,level:a,guid:n,editable:!!this.options.editable,color:s[a-1]||s[0]})));if(i.attributes)l.attr(JSON.parse(JSON.stringify(i.attributes)));d=I(t(p(true,{},i,{menuLabel:r.menuLabel,level:a,guid:n,editable:!!this.options.editable,color:s[a-1]||s[0]})));l.append(d);o.append(l);return o},_renderGroup:function(){return false},_restoreSelection:function(){var e,t;if(!this._idTabIndex){t=this.element.find(y+this._selector).first();t.attr(m,"0")}else{e=this.dataSource.get(this._idTabIndex);t=e?this._getToFocus(e):this.element.find(y+this._selector).first();t.attr(m,"0");this._idTabIndex=null}if(this._shouldRestoreSelection){this._shouldRestoreSelection=false;this._preventTriggerSelect=true;t.trigger("focus");t.addClass(S.focused)}},_setHeight:function(){var e=this._selector,t=this.element.find(y+S.button+h+y+e),n=Number.MAX_VALUE,r=0,i;this._calculateDimensions();i=this._buttonHeight;this.element.find(y+S.lineVerticalTop).height(this._spacing+i/2);t.each(function(e,t){var i=I(t).offset().top,a=i+I(t).outerHeight(true);if(i<n)n=i;if(a>r)r=a});this.element.height(r-n)}}),N=M.extend({init:function(e,t){M.fn.init.call(this,e,t);this._selector=S.card},collapse:function(e){var t=this.jqueryItemElement(e);if(!t)return;this.dataSource.toggleChildren(this._dataItem(t),false).then(this.refresh.bind(this))},expand:function(e){var t=this.jqueryItemElement(e);if(!t)return;this.dataSource.toggleChildren(this._dataItem(t),true).then(this.refresh.bind(this))},_calculateItemWidth:function(){return this.element.find(y+this._selector).first().outerWidth(true)},_calculateLevel:function(e,t){var i=e.length,a=this._maxColumnsPerLevel,n=false,r=false,s,o,d;if(!a[t]||a[t]<i){s=a[t];r=true;a[t]=i}for(o=0;o<i;o++){d=e[o];if(d.hasChildren){n=true;if(d.expanded)this._calculateLevel(d.children,t+1)}}if(!n&&r&&t>0){r=false;a[t]=s||1}},_calculateLevels:function(){var e=this._itemsTree,t=this._maxColumnsPerLevel=[],i=1,a;this._calculateLevel(e,0);for(a=0;a<t.length;a++)i=i*t[a];this._total=i},_dataItems:function(e){var t=this.dataSource.getByUid(e.data(s));if(t)return[t];else return null},_generateItemsTree:function(){this._itemsTree=this.dataSource.itemsTree()},_getToFocus:function(e){return this.element.find("[data-uid='"+e.get(s)+"']")},_getToSelect:function(e){return this.jqueryItemElement(e)},_groupIsVertical:function(e){var t=e.closest(y+S.group);return t.hasClass(S.groupVertical)},_keyCollapse:function(e){var t=this._dataItem(e),i,a;if(t.expanded){if(!this.trigger(d,{item:e,dataItems:[t]}))this.collapse(e)}else if(t.parentId){i=this.dataSource.get(t.parentId).get(s);a=this.element.find("[data-uid='"+i+"']");this.trigger(o,{item:a,dataItems:[this._dataItem(a)]})}},_keyEnter:function(e){if(e.find(y+S.cardMenu).length>0)this.trigger(c,e)},_keyExpand:function(e){var t=this._dataItem(e),i=this.element.find(f+e.attr(_)),a;if(!t.hasChildren)return;if(!t.expanded){if(!this.trigger(u,{item:e,dataItems:[t]}))this.expand(e)}else{a=i.find(y+this._selector).first();this.trigger(o,{item:a,dataItems:[this._dataItem(a)]})}},_keyNext:function(e){var t=this._dataItem(e),i=e.parent().next(y+S.node).find(y+S.card),a=this.element.find(f+e.attr(_));if(!i.length&&t.hasChildren&&t.expanded)i=a.find(y+S.card).first();if(i.length===0||i.hasClass(S.focused))return;this.trigger(o,{item:i,dataItems:[this._dataItem(i)]})},_keyPrev:function(e){var t=this._dataItem(e),i=e.parent().prev(y+S.node).find(y+S.card),a;if(!i.length&&t.parentId){a=this.dataSource.get(t.parentId).get(s);i=this.element.find("[data-uid='"+a+"']")}if(i.length===0||i.hasClass(S.focused))return;this.trigger(o,{item:i,dataItems:[this._dataItem(i)]})},_onFocus:function(e){var t=I(e.currentTarget),i=I(e.target);if(this._preventTriggerSelect){e.stopPropagation();this._preventTriggerSelect=false;return}if(i.hasClass(S.cardMenu))if(i.closest("[tabindex='0']").length>0){e.stopPropagation();return}else this._preventTriggerSelect=true;if(!t.hasClass(S.card))t=t.closest(y+S.card);if(!t.hasClass(S.focused))this.trigger(o,{item:t,dataItems:[this._dataItem(t)]})},_onSelect:function(e){var t=I(e.currentTarget),i=t.hasClass(S.card)?t:t.closest(y+S.card),a=I(e.target).hasClass(S.cardMenu)?I(e.target):I(e.target).closest(y+S.cardMenu);if(a.length>0)return;if(!t.hasClass(S.focused))this.trigger(o,{item:i,dataItems:[this._dataItem(i)]})},_orientation:function(e,t,i){var a=I("<div>").addClass(S.line+w+S.lineVertical);if(i&&t>1){e.addClass(S.groupVertical+w+S.vstack);e.find(y+S.nodeContainer).addClass(S.vstack);if(e.find(y+S.button).length===0||e.find(y+S.card).length===1){e.find(y+S.card).before(a.clone());e.find(y+S.node).first().find(y+S.lineVertical).addClass(S.lineVerticalTop)}else if(t>1)e.find(y+S.card).first().before(a.clone())}else{e.addClass(S.groupHorizontal+w+S.hstack);e.find(y+S.nodeContainer).addClass(S.hstack);if(t>1)e.find(y+S.card).before(a.clone().addClass(S.lineVerticalTop))}},_renderGroup:function(e,t,i,a,n){var r=true,s;s=I(H);e.append(s);r=this._renderInner(s,t,i,a,n);this._orientation(e,i,r)},_renderInner:function(u,e,c,h,f){var p=C.template(O),g=C.template(V),t=h/e.length,i=true,m=I("<div>").addClass(S.line+w+S.lineVertical),v=I("<div>").addClass(S.line+w+S.lineHorizontal),_=this.options.messages,a,n,r,s,o,d,k,b,l;if(!this.options.template)l=C.template(L);else if(typeof this.options.template==="function")l=this.options.template;else l=C.template(this.options.template);for(a=0;a<e.length;a++){n=e[a];r=C.guid();s=this._renderNode(g,l,n,c,r);if(n.hasChildren){s.append(m.clone());o=I(p({buttonSign:n.expanded?T:F,label:n.expanded?_.collapse:_.expand}));s.append(o)}u.append(s);this._calculateDimensions();k=this._itemWidth;b=this._spacing;if(n.hasChildren){i=false;if(n.expanded)d=this._renderInnerGroup(n,t,f,a,c,r)}if(!!d&&d.hasClass(S.groupHorizontal)&&n.expanded&&!!n.children&&n.children.length>1)o.after(v.clone().css({width:(t-t/n.children.length)*(k+b)+x,"margin-top":this._buttonHeight/-2+x}))}if(t>1&&!i)u.find(y+S.node).width((t-1)*(b+k));return i},_renderInnerGroup:function(e,t,i,a,n,r){var s=this._itemWidth,o=this._spacing,u=t*s+(t-1)*o,d=a*t*s+i,c=C.template(E),h=C.support.isRtl(this.element)?"right":"left",f=n*(this._itemHeight+this._buttonHeight+o)+o*(n-1)-this._buttonHeight/2,l;if(a>0)d+=a*t*o;l=I(c({guid:r,level:n+1}));l.css({width:u+x,top:f+x});l.css(h,d+x);this.element.append(l);this._renderGroup(l,e.children,n+1,t,d);return l}}),j=M.extend({init:function(e,t){M.fn.init.call(this,e,t);this._selector=S.nodesGroupContainer},collapse:function(e){var t=this.jqueryGroupElement(e),i,a;if(!t)return;i=this._dataItems(t);for(a=0;a<i.length;a++)this.dataSource.toggleChildren(i[a],false).then(this.refresh.bind(this))},expand:function(e){var t=this.jqueryGroupElement(e),i,a;if(!t)return;i=this._dataItems(t);for(a=0;a<i.length;a++)this.dataSource.toggleChildren(i[a],true).then(this.refresh.bind(this))},_dataItems:function(e){var i=this.dataSource,a=[],t,n,r;if(e.hasClass(S.card)){n=i.getByUid(e.data(s));if(n)a.push(n)}else if(e.hasClass(S.nodesGroupContainer)){this._groupFocused=true;t=e.find(y+S.card);t.each(function(e,t){r=i.getByUid(t.getAttribute("data-uid"));if(r)a.push(r)})}return a},_calculateItemWidth:function(){var e=this.element.find(y+this._selector).first(),t=this.element.find(y+S.card).first().outerWidth(true),i=Number(e.css("padding-left").split(x)[0]),a=Number(e.css("border-left").split(x)[0]);return t+2*i+2*a},_calculateLevel:function(e,t){var i=e.length,a=false,n=0,r,s,o;this._maxColumnsPerLevel[t]=this._maxColumnsPerLevel[t]||0;this._maxGroups[t]=this._maxGroups[t]||0;for(s=0;s<i;s++){o=e[s];r=o.items.length;if(r>n)n=r;o=e[s];if(o.hasChildren){a=true;if(o.expanded)this._calculateLevel(o.children,t+1)}}if(i>this._maxGroups[t])this._maxGroups[t]=i;if(!a)n=1;if(n>this._maxColumnsPerLevel[t])this._maxColumnsPerLevel[t]=n},_calculateLevels:function(){var e=this._itemsTree,t=this._maxColumnsPerLevel=[],i=this._maxGroups=[],a=1,n,r;this._calculateLevel(e,0);for(n=t.length-1;n>=0;n--){r=t[n]*i[n];if(a>t[n])a=a*i[n];else if(a<r)a=r}this._total=a},_generateItemsTree:function(){this._itemsTree=this.dataSource.groupedItemsTree(this.options.groupField)},_getToFocus:function(e){if(!this._groupFocused)return this.element.find("[data-uid='"+e.get(s)+"']");else{this._groupFocused=false;return this.element.find("[data-uid='"+e.get(s)+"']").closest(y+S.nodesGroupContainer)}},_getToSelect:function(e){var t=this.jqueryItemElement(e);return t||this.jqueryGroupElement(e)},_groupIsVertical:function(e){var t=e.closest(y+S.nodeContainer);return t.hasClass(S.vstack)},_keyCollapse:function(e){var t=[],i,a;t=this._dataItems(e);a=t.some(function(e){return e.expanded});if(a){if(e.hasClass(S.card)){e=e.closest(y+S.nodesGroupContainer);t=this._dataItems(e)}if(!this.trigger(d,{item:e,dataItems:t}))this.collapse(e)}else if(t[0].parentId){i=this.dataSource.get(t[0].parentId).get(s);this.trigger(o,{item:this.element.find("[data-uid='"+i+"']").closest(y+this._selector),dataItems:t})}},_keyEnter:function(e){var t,i=[];if(e.hasClass(S.card)&&e.find(y+S.cardMenu).length>0)this.trigger(c,e);else{t=e.find(y+S.card).first();i=this._dataItems(t);this.trigger(o,{item:t,dataItems:i})}},_keyEscape:function(e){if(!e.hasClass(S.card))return;var t=e.closest(y+S.nodesGroupContainer),i=this._dataItems(t);this.trigger(o,{item:t,dataItems:i})},_keyExpand:function(e){var t=e.attr(_)||e.closest(y+this._selector).attr(_),i=this.element.find(f+t),a=this._dataItems(e),n,r,s;n=a.some(function(e){return e.hasChildren});if(!n)return;r=a.some(function(e){return e.expanded});if(!r){if(e.hasClass(S.card)){e=e.closest(y+S.nodesGroupContainer);a=this._dataItems(e)}if(!this.trigger(u,{item:e,dataItems:a}))this.expand(e)}else{s=i.find(y+this._selector).first();this.trigger(o,{item:s,dataItems:this._dataItems(s)})}},_keyNext:function(e){var t=this.element.find(f+e.attr(_)),i=this._dataItems(e),a=i.some(function(e){return e.hasChildren}),n=i.some(function(e){return e.expanded}),r;if(e.hasClass(S.card))r=e.parent().next(y+S.node).find(y+S.card);else r=e.parent().next(y+S.nodesGroup).find(y+S.nodesGroupContainer);if(!r.length&&a&&n)r=t.find(y+this._selector).first();if(r.length===0)return;this.trigger(o,{item:r,dataItems:this._dataItems(r)})},_keyPrev:function(e){var t=this._dataItems(e),i,a;if(e.hasClass(S.card))a=e.parent().prev(y+S.node).find(y+S.card);else a=e.parent().prev(y+S.nodesGroup).find(y+S.nodesGroupContainer);if(!a.length&&t[0].parentId){i=this.dataSource.get(t[0].parentId).get(s);a=this.element.find("[data-uid='"+i+"']").closest(y+this._selector)}if(a.length===0)return;this.trigger(o,{item:a,dataItems:this._dataItems(a)})},_onFocus:function(e){var t=I(e.target),i,a;if(this._preventTriggerSelect){e.stopPropagation();this._preventTriggerSelect=false;return}if(t.hasClass(S.cardMenu))if(t.closest("[tabindex='0']").length>0){e.stopPropagation();return}else this._preventTriggerSelect=true;if(!t.hasClass(S.card)&&!t.hasClass(S.nodesGroupContainer)){a=t.closest(y+S.card);if(!a.length)a=t.closest(y+S.nodesGroupContainer);t=a}if(t.length===0)return;i=this._dataItems(t);if(!t.hasClass(S.focused)){e.stopPropagation();this.trigger(o,{item:t,dataItems:i})}},_onSelect:function(e){var t=I(e.target),i=this.element.find("[tabindex=0]"),a,n;if(!t.hasClass(S.card)&&!t.hasClass(S.nodesGroupContainer)){n=t.closest(y+S.card);if(!n.length)n=t.closest(y+S.nodesGroupContainer);t=n}if(t.length===0||i[0]===t[0])return;a=this._dataItems(t);this.trigger(o,{item:t,dataItems:a})},_orientation:function(e,t,i){var a=I("<div>").addClass(S.line+w+S.lineVertical+w+S.lineVerticalTop);e.addClass(S.hstack);if(t>1)e.find(y+S.nodesGroupContainer).before(a.clone());if(i&&t>1){e.find(y+S.nodeContainer).removeClass(S.hstack);e.find(y+S.nodeContainer).addClass(S.vstack)}else e.addClass(S.groupHorizontal)},_renderChildren:function(e,t,i,a,n,u,c){var h=C.template(O),f=C.template(E),p=I("<div>").addClass(S.line+w+S.lineVertical),g=I("<div>").addClass(S.line+w+S.lineHorizontal),m=this.options.messages,v=true,_=C.support.isRtl(this.element)?"right":"left",r,s,o,k,b,d,l;if(e.hasChildren){v=false;n.append(p.clone());s=I(h({buttonSign:e.expanded?T:F,label:e.expanded?m.collapse:m.expand}));n.append(s);this._calculateDimensions();d=this._itemWidth;l=this._spacing;if(e.expanded){b=d*i+(i-1)*l;o=t*i*d+u;k=a*(this._itemHeight+this._buttonHeight+l)+l*(a-1)-this._buttonHeight/2;if(t>0)o+=t*i*l;r=I(f({guid:c,level:a+1}));r.css({width:b+x,top:k+x});r.css(_,o+x);this.element.append(r);this._renderGroup(r,e.children,a+1,i,o)}}if(!!r&&e.expanded&&!!e.children&&e.children.length>1)s.after(g.clone().css({width:(i-i/e.children.length)*(d+l)+x,"margin-top":this._buttonHeight/-2+x}));return v},_renderGroup:function(e,t,i,u,c){var a=true,n=u/t.length,r,s,o,d,h,l;for(o=0;o<t.length;o++){d=C.guid();l=t[o];r=this._renderNodesContainer(e,p(true,{},l,{guid:d,level:i}));s=r.closest(y+S.nodesGroup);this._renderItems(r,l.items,i,d);h=this._renderChildren(l,o,n,i,s,c,d);if(a)a=h}var f=this._itemWidth*n+(n-1)*this._spacing;e.find(y+S.nodesGroup).width(f);this._orientation(e,i,a)},_renderItems:function(e,t,i,a){var n=C.template(W),r,s,o,d;if(!this.options.template)d=C.template(L);else if(typeof this.options.template==="function")d=this.options.template;else d=C.template(this.options.template);for(r=0;r<t.length;r++){s=t[r];o=this._renderNode(n,d,s,i,a);e.append(o)}},_renderNodesContainer:function(e,t){var i=C.template(G),a=I('<div class="k-orgchart-node-group k-align-items-center k-vstack">'),n=I(D),r=I(i(t)),s;if(typeof this.options.groupHeaderTemplate==="function")s=this.options.groupHeaderTemplate;else s=C.template(this.options.groupHeaderTemplate);r.append(s({value:t.value,field:t.field}));r.append(n);a.append(r);e.append(a);return n}});return C.orgChart={View:M,SingleView:N,GroupedView:j},window.kendo})}("function"==typeof define&&define.amd?define:function(e,t,i){(i||t)()}),function(define){define("kendo.orgchart.min",["./orgchart/data.min","./orgchart/view.min","kendo.menu.min","kendo.dialog.min","kendo.form.min","kendo.upload.min","kendo.window.min"],function(){var e={id:"orgchart",name:"OrgChart",category:"web",description:"The OrgChart widget displays hierarchical organizational structure.",depends:["core","menu","dialog","form","upload","window"]},o=window.kendo.jQuery,n=void 0,d=window.kendo,a=d.ui.DataBoundWidget,s=d.data.OrgChartDataSource,f=d.ui.ContextMenu,l=o.extend,p=Array.isArray,g=".kendoOrgChart",m="cancel",i="change",u="click",t="collapse",v="create",_="dataBinding",k="dataBound",b="delete",I="destroy",C="edit",y="error",w="expand",x="focus",S,F="menu",T="progress",E="save",G="select",H="requestStart",c=".",D=" ",P=",",O="id",L="uid",V="action",h={wrapper:"k-orgchart",container:"k-orgchart-container",line:"k-orgchart-line",lineVertical:"k-orgchart-line-v",lineHorizontal:"k-orgchart-line-h",lineVerticalTop:"k-orgchart-line-v-top",group:"k-orgchart-group",groupVertical:"k-orgchart-group-v",groupHorizontal:"k-orgchart-group-h",nodesGroup:"k-orgchart-node-group",nodesGroupContainer:"k-orgchart-node-group-container",nodeContainer:"k-orgchart-node-container",node:"k-orgchart-node",card:"k-orgchart-card",cardMenu:"k-orgchart-card-menu",button:"k-orgchart-button",focused:"k-focus",plusIcon:"k-i-plus",menuItem:"k-item",avatarPreview:"k-orgchart-avatar-preview",update:"k-orgchart-update",cancel:"k-orgchart-cancel",vstack:"k-vstack",hstack:"k-hstack",closeButton:"k-i-close"},r={edit:"<li data-action='edit'>#: edit #</li>",create:"<li data-action='create'>#: create #</li>",destroy:"<li data-action='destroy'>#: destroy #</li>"},W,M='<div class="k-orgchart-avatar-preview k-hstack k-align-items-center k-pb-lg">'+'<div class="k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full">'+'<span class="k-avatar-image">'+'<img src="#: avatar #" alt="#: name #">'+"</span>"+"</div>"+'<div class="k-px-md">#: fileName #</div>'+'<button class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button" aria-label="#: destroy #">'+'<span class="k-button-icon k-icon k-i-delete"></span>'+"</button>"+"</div>",N='<div class="k-edit-buttons">'+'<button type="button" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-orgchart-cancel">'+'<span class="k-button-text">#: cancel #</span>'+"</button>"+'<button type="button" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary k-orgchart-update">'+'<span class="k-button-text">#: save #</span>'+"</button>"+"</div>",j=a.extend({init:function(e,t,i){if(p(t))t={dataSource:t};t=t||{};a.fn.init.call(this,e,t);if(i)this._events=i;this._wrapper();this._view();this._dataSource();this._contextMenu();if(this.options.autoBind)this.dataSource.fetch();d.notify(this)},options:{name:"OrgChart",autoBind:true,cardsColors:null,dataSource:{},editable:{create:true,destroy:true,fields:true,form:{buttonsTemplate:"",orientation:"vertical"},parent:true},groupField:null,groupHeaderTemplate:"<div>"+'<div class="k-orgchart-node-group-title">#: value #</div>'+'<div class="k-orgchart-node-group-subtitle">#: field #</div>'+"</div>",template:null,messages:{label:"Org Chart",edit:"Edit",create:"Create",destroy:"Delete",destroyContent:"Are you sure you want to delete this item and all its children?",destroyTitle:"Delete item",cancel:"Cancel",save:"Save",menuLabel:"Edit menu",uploadAvatar:"Upload new avatar",parent:"Parent",name:"Name",title:"Title",none:"--None--",expand:"expand",collapse:"collapse"}},events:[m,i,t,v,_,k,b,C,w,"kendoKeydown",E,G],destroy:function(){if(this._menu)this._menu.destroy();if(this._editWindow)this._editWindow.destroy();if(this._confirmDestroy)this._confirmDestroy.destroy();this.view.destroy();a.fn.destroy.call(this);this.wrapper.off(g)},setDataSource:function(e){this.options.dataSource=e;this._dataSource();if(this.options.autoBind)e.fetch()},setOptions:function(e){var t=this;a.fn.setOptions.call(t,e)},append:function(e,t){var i=this,a=i.view.jqueryItemElement(t),n=i.dataItem(a);if(!a||!n)return;if(!n.loaded())i.dataSource.read({id:n.id}).then(function(){i.dataSource.add(l({},e,{parentId:n.id}));i.dataSource.sync()});else{i.dataSource.add(l({},e,{parentId:n.id}));i.dataSource.sync()}},cancelChanges:function(){if(this.dataSource.hasChanges())this.dataSource.cancelChanges()},collapse:function(e){return this.view.collapse(e)},dataItem:function(e){var t=this.view.jqueryItemElement(e);if(!t||!t.data(L))return;return this.dataSource.getByUid(t.data(L))},delete:function(e){var t=this.view.jqueryItemElement(e);if(!t)return;this.dataSource.remove(this.dataItem(t));this.dataSource.sync()},edit:function(e){var t=this.view.jqueryItemElement(e),i=this.dataItem(t);if(!t||!i)return;this._edit(i)},expand:function(e){return this.view.expand(e)},getCollapsedNodes:function(){return this.wrapper.find("[aria-expanded='false']")},items:function(){return this.wrapper.find(c+h.card)},parent:function(e){var t=this.view.jqueryItemElement(e),i;if(!t)return;i=t.closest(c+h.group).attr(O);return this.wrapper.find("[aria-owns='"+i+"']")},saveChanges:function(){this.dataSource.sync()},select:function(e){var t=this.view._getToSelect(e);if(!t)return;else return this.view.select(t)},_avatarPreview:function(e,t){var i=this._form,a=e.avatar,n=function(){r.find(c+h.avatarPreview).remove();e.set("avatar",null)},r,s;if(!i)return;if(!t){t=a.split("\\").pop().split("/").pop();if(!t||t.indexOf(".")==-1)t=e.name}s={name:e.name,avatar:a,fileName:t,destroy:this.options.messages.destroy};r=i.wrapper;r.find(c+h.avatarPreview).remove();r.find('[type="file"]').closest(c+"k-form-field").prepend(d.template(M)(s));r.find(c+h.avatarPreview+D+c+"k-button").on(u,n)},_contextMenu:function(){var e=this.options,t=e.editable,i=e.messages,a={target:this.wrapper,filter:c+h.cardMenu,select:this._onMenuItemClick.bind(this),activate:this._onMenuOpen.bind(this),deactivate:this._onMenuClose.bind(this),showOn:"click",animation:false},n;if(t===true||t!==false&&(t.create||t.destroy||t.fields||t.parent)){n="<ul>";if(t===true){n+=r.edit;n+=r.create;n+=r.destroy}else{if(t.fields||t.parent)n+=r.edit;if(t.create)n+=r.create;if(t.destroy)n+=r.destroy}n=d.template(n)(i);this._menu=new f(n,a)}},_dataSource:function(){var e=this.dataSource,t=this.options.dataSource;if(e){e.unbind(i,this._dataSourceChangeHandler);e.unbind(y,this._errorHandler);e.unbind(T,this._progressHandler);e.unbind(H,this._requestStartHandler)}this._dataSourceChangeHandler=this._onDataSourceChange.bind(this);this._errorHandler=this._onDataSourceError.bind(this);this._progressHandler=this._progress.bind(this);this._requestStartHandler=this._onDataSourceRequestStart.bind(this);e=this.dataSource=s.create(t);e.bind(i,this._dataSourceChangeHandler);e.bind(y,this._errorHandler);e.bind(T,this._progressHandler);e.bind(H,this._requestStartHandler);this.view.dataSource=e},_destroyItem:function(e){var t=this,i=o("<div></div>"),a=t.options.messages,n=function(){t.wrapper.find(c+h.card+"[tabindex=0]"+P+c+h.nodesGroup+"[tabindex=0]").addClass(h.focused).trigger("focus")},r=this._confirmDestroy=new d.ui.Confirm(i,{title:a.destroyTitle,content:a.destroyContent,messages:{okText:a.destroy,cancel:a.cancel},show:function(){setTimeout(function(){r.element.trigger("focus")})}});r.open();r.result.done(function(){if(!t.trigger(b,{dataItem:e})){t.dataSource.remove(e);t.dataSource.sync()}t.view._shouldRestoreSelection=true;t.view._restoreSelection()});r.result.fail(n)},_edit:function(t){var i=this,e=o("<div>"),a=o("<div>"),n=this.options.messages,r=this._formOptions(t),s;if(!r)return;i._form=new d.ui.Form(e,r);if(!!t.avatar)i._avatarPreview(t);a.append(e);i._editWindow=new d.ui.Window(a,{title:n.edit,width:"380 px",modal:true,close:function(e){if(!s)if(!i.trigger(m,{dataItem:t}))i.cancelChanges();else e.preventDefault();else s=false},deactivate:function(){a.off(u);i._editWindow.destroy();i._editWindow=null;i.view._restoreSelection()}});a.append(d.template(N)({save:n.save,cancel:n.cancel}));i._editWindow.center().open();a.on(u,c+h.update,function(){if(i._form.validate()){s=true;if(!i.trigger(E,{dataItem:t})){i._editWindow.close();i.saveChanges()}}});a.on(u,c+h.cancel,function(){i._editWindow.close()})},_formOptions:function(e){var t=this.options,i=t.messages,a=t.editable.form,n=[],r,s;if(a)s=a.items;if((!s||s.length===0)&&(t.editable===true||t.editable&&t.editable.parent)){r=[{id:null,name:i.none}].concat(this.dataSource.prospectParents(e));n.push({field:"parentId",editor:"DropDownList",label:i.parent,editorOptions:{dataSource:r,dataValueField:"id",dataTextField:"name",valuePrimitive:true}})}if((!s||s.length===0)&&(t.editable===true||t.editable&&t.editable.fields))n=n.concat([{field:"name",label:i.name,validation:{required:true}},{field:"title",label:i.title},{field:"avatar",label:i.uploadAvatar,editor:this._uploadEditor.bind(this,e)}]);if(a)delete a.formData;if(n.length>0||s&&s.length>0)return l(true,{},{formData:e,items:n},a);else return false},_onDataSourceChange:function(e){if(e.action==="add"||e.action==="itemchange"&&this._editWindow)return;if(!e.action||e.action==="sync")if(this.trigger(_,e)){this._progress(false);return}this._progress(true);this.view.refresh();if(!e.action||e.action==="sync")this.trigger(k);this._progress(false)},_onDataSourceError:function(){this._progress(false)},_onDataSourceRequestStart:function(){this.view._cacheFocused()},_onMenuClose:function(){if(o(document.activeElement).closest("[role='alertdialog']").length===0)this.wrapper.find("[tabindex='0']").addClass(h.focused).trigger("focus")},_onMenuItemClick:function(e){var t=this,i=o(e.target).closest(c+h.node).find(c+h.card),a=t.dataItem(i),n=o(e.item).data(V),r;if(!a)return;if(n===C){if(!t.trigger(C,{dataItem:a}))t._edit(a)}else if(n===v){if(!t.trigger(v,{dataItem:a}))if(!a.loaded())t.dataSource.read({id:a.id}).then(function(){r=t.dataSource.add({parentId:a.id});t._edit(r)});else{r=t.dataSource.add({parentId:a.id});t._edit(r)}}else if(n===I)t._destroyItem(a)},_onMenuOpen:function(){this.view._cacheFocused();this.wrapper.find(c+h.focused).removeClass(h.focused);this._menu.element.find(c+h.menuItem).first().trigger(x)},_openMenu:function(e){if(this._menu)this._menu.open(e.find(c+h.cardMenu))},_progress:function(e){d.ui.progress(this.container,e)},_triggerCollapse:function(e){if(this.trigger(t,{item:e.item,dataItems:e.dataItems}))e.preventDefault()},_triggerExpand:function(e){if(this.trigger(w,{item:e.item,dataItems:e.dataItems}))e.preventDefault()},_triggerSelect:function(e){if(!this.trigger(G,{item:e.item,dataItems:e.dataItems})){this.view.select(e.item);this.trigger(i,{item:e.item,dataItems:e.dataItems})}},_uploadEditor:function(n,e){var r=this;o('<input type="file">').appendTo(e).kendoUpload({async:false,multiple:false,select:function(e){var t=e.files[0];var i=t.rawFile;var a=new FileReader;if(t.validationErrors&&t.validationErrors.length>0)return;if(i){a.onloadend=function(){n.set("avatar",this.result);r._avatarPreview(n,i.name)};a.readAsDataURL(i)}},validation:{allowedExtensions:[".gif",".jpg",".png"],maxFileSize:1048576}})},_view:function(){if(this.options.groupField!==null&&this.options.groupField!==n)this.view=new d.orgChart.GroupedView(this.container,this.options);else this.view=new d.orgChart.SingleView(this.container,this.options);this.view.bind(G,this._triggerSelect.bind(this));this.view.bind(w,this._triggerExpand.bind(this));this.view.bind(t,this._triggerCollapse.bind(this));this.view.bind(F,this._openMenu.bind(this))},_wrapper:function(){var e=o("<div class='k-orgchart-container'>");this.wrapper=this.element;this.container=e;this.wrapper.addClass(h.wrapper);this.wrapper.append(e)}});return d.ui.plugin(j),window.kendo})}("function"==typeof define&&define.amd?define:function(e,t,i){(i||t)()});
//# sourceMappingURL=kendo.orgchart.min.js.map
